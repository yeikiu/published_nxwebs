import{aM as ge}from"./lucide-qo0zz29p.js";import{$ as Pe,a as Be}from"./index-CcyEaRjB.js";function st(){const t=ge(Pe)("charts.fight_radar_categories");return Array.isArray(t)?t:["Striking Offense","Striking Defense","Takedown Offense","Takedown Defense","Control","Finish Threat"]}function it(){const t=ge(Pe)("charts.iq_radar_categories");return Array.isArray(t)?t:["Distance","Adaptability","Composure","Decisions","Rhythm","Feints"]}function Se(e){const t=Number(e.Sig_Strikes_Landed)||0,s=Number(e.Sig_Strikes_Thrown)||0,n=Number(e.Sig_Strikes_Absorbed)||0,o=Number(e.significant_strikes_attempted_against)||0,i=Number(e.Takedowns_Successful)||0,r=Number(e.Takedowns_Attempted)||0,c=Number(e.Takedowns_Defended)||0,a=Number(e.takedowns_attempted_against)||0,l=Number(e.Control_Time_Seconds)||0,h=Number(e.Time_Controlled_Seconds)||0,T=Number(e.Number_of_Fights_36m)||1,g=Number(e.win_ko)||0,m=Number(e.win_tko)||0,u=Number(e.win_sub)||0;let _=s>0?t/s*100:0,d=o>0?(o-n)/o*100:85,p=r>0?i/r*100:45,F=a>0?c/a*100:85,A=l+h>0?l/(l+h)*100:50,k=T>0?(g+m+u)/T*100:0;const f={STR_OFF:_,STR_DEF:d,TD_OFF:p,TD_DEF:F,CTRL:A,FIN_THREAT:k};return{STR_OFF:f.STR_OFF>100?100:Math.round(f.STR_OFF),STR_DEF:f.STR_DEF>100?100:Math.round(f.STR_DEF),TD_OFF:f.TD_OFF>100?100:Math.round(f.TD_OFF),TD_DEF:f.TD_DEF>100?100:Math.round(f.TD_DEF),CTRL:f.CTRL>100?100:Math.round(f.CTRL),FIN_THREAT:f.FIN_THREAT>100?100:Math.round(f.FIN_THREAT)}}function Le(e,t){const s=e.Sig_Strikes_Landed||0,n=e.Sig_Strikes_Thrown||0,o=e.Sig_Strikes_Absorbed||0,i=e.significant_strikes_attempted_against||0,r=e.Takedowns_Defended||0,c=e.takedowns_attempted_against||0,a=e.Fight_Duration_Seconds||1,l=e.win||0,h=e.loss||0,T=e.draws||0,g=e.win_ko||0,m=e.win_tko||0,u=e.win_sub||0,_=e.Knockdowns||0,d=e.Knockdowns_Received||0,p=a/60,F=l+h+T||1,A=p>0?s/(p*F):0,k=n>0?s/n*100:0,f=i>0?o/i*100:0,N=c>0?r/c*100:0,P=l/F,L=(g+m+u)/F*100,y=e.reach_inches||70,b=e.height_inches||70,C=y-b,O=Math.min(Math.max(C-2,0),10)*4,W=s-o,D=W>0?Math.min(W*.3,40):Math.max(W*.2,-20),I=40+O+D,Q=Math.round(Math.min(Math.max(I,15),85)),S=(f+N)/2-o/Math.max(F,1),j=Math.max(S*.8,0),E=p*F,Y=E>10?Math.min((E-10)*2,25):0,z=F-d,J=Math.min(z*3,20),Z=40+j+Y+J,K=Math.round(Math.min(Math.max(Z,20),85)),X=Math.min(P*.4,.4),$=((g>0?1:0)+(m>0?1:0)+(u>0?1:0))/3*.15;let R=0;t.isTriple?R=.25:t.isDual?R=.15:R=-.1;const V=X+$+R,ee=Math.round(Math.min(Math.max(V*100,5),95)),v=P>L/100?Math.min((P-L/100)*50,25):0,te=e.Takedowns_Attempted>0?e.Takedowns_Successful/e.Takedowns_Attempted*30:15,se=e.Control_Time_Seconds||0,ie=e.Time_Controlled_Seconds||0,B=se-ie,U=B>0?Math.min(B*.15,20):Math.max(B*.1,-15),ne=35+v+te+U,oe=Math.round(Math.min(Math.max(ne,15),85)),re=n-o,ce=re>0?Math.min(re*.25,30):0,x=p*F,ae=x<8?Math.min((8-x)*5,25):x>12?Math.max((12-x)*2,-15):10,_e=A>3?Math.min((A-3)*8,20):A*6,le=35+ce+ae+_e,de=Math.round(Math.min(Math.max(le,15),85)),me=n>0?k/100:0,ve=me>.5?Math.min((me-.5)*80,30):0,he=_-d,we=he>0?Math.min(he*15,25):Math.max(he*5,-15),ye=B>60?Math.min((B-60)*.1,15):0,be=35+ve+we+ye,Ee=Math.round(Math.min(Math.max(be,15),85));return{distance:Q,adaptability:ee,composure:K,decisions:oe,rhythm:de,feints:Ee}}class Me{constructor(t){this.metrics=this.calculateMetrics(t)}calculateMetrics(t){const s=t.win||0,n=t.loss||0,o=t.draws||0,i=s+n+o,r=t.win_ko||0,c=t.win_tko||0,a=t.win_sub||0,l=t.Knockdowns||0,h=t.Knockdowns_Received||0,T=n===0&&s>0,g=i>0?s/i:0,m=r+c+a,u=i>0?m/i*100:0,_=h>0?l/h:l+1,d=t.Fight_Duration_Seconds>0?t.Fight_Duration_Seconds/60:15;return{isUndefeated:T,wins:s,losses:n,winRate:g,finishRate:u,totalFights:t.Number_of_Fights_36m||i,knockdowns:l,knockdownsReceived:h,knockdownRatio:_,subWins:a,koTkoWins:r+c,avgFightTime:d,isEliteFinisher:u>70&&i>=4,isSubmissionSpecialist:a>=3&&T,isKnockoutArtist:r+c>=3&&l>h+2}}getStrikingOffenseBonuses(){const t=this.metrics;return t.isUndefeated&&t.isEliteFinisher?{primary:t.isKnockoutArtist?1.44:1.25,secondary:1.15,additive:8}:t.isUndefeated&&t.finishRate>50?{primary:1.18,secondary:1.1,additive:5}:t.isUndefeated&&t.totalFights>=3?{primary:1.12,secondary:1.05,additive:3}:t.winRate>.85&&t.totalFights>=5?{primary:1.08,secondary:1.03,additive:2}:{primary:1,secondary:1,additive:0}}getDefensiveBonuses(){const t=this.metrics;return t.winRate===1&&t.totalFights>=4?{primary:1.15,secondary:1.1,additive:4}:t.winRate>.9&&t.totalFights>=4?{primary:1.08,secondary:1.05,additive:2}:{primary:1,secondary:1,additive:0}}getFinishingBonuses(){const t=this.metrics;return t.isUndefeated&&t.isEliteFinisher?{primary:t.isSubmissionSpecialist?1.68:1.4,secondary:1.2,additive:15}:t.isUndefeated&&t.finishRate>50?{primary:1.3,secondary:1.15,additive:10}:t.isUndefeated&&t.totalFights>=3?{primary:1.2,secondary:1.1,additive:6}:{primary:1,secondary:1,additive:0}}getControlBonuses(){const t=this.metrics;return t.isSubmissionSpecialist?{primary:1.25,secondary:1.15,additive:8}:t.isUndefeated&&t.totalFights>=4?{primary:1.1,secondary:1.05,additive:3}:{primary:1,secondary:1,additive:0}}getVolumeBonuses(){const t=this.metrics;if(t.isUndefeated&&t.isEliteFinisher){let s=1.4,n=30;return t.isKnockoutArtist&&(s*=1.15,n+=12),t.isSubmissionSpecialist&&(s*=1.18,n+=15),{primary:Math.min(s,1.8),secondary:1.18,additive:Math.min(n,50)}}else{if(t.isUndefeated&&t.finishRate>50)return{primary:1.25,secondary:1.12,additive:20};if(t.isUndefeated&&t.totalFights>=3)return{primary:1.15,secondary:1.08,additive:15}}return{primary:1,secondary:1,additive:0}}getEliteClassification(){const t=this.metrics;return t.isUndefeated&&t.isEliteFinisher?t.isKnockoutArtist&&t.isSubmissionSpecialist?"Complete Dominator":t.isKnockoutArtist?"Knockout Artist":t.isSubmissionSpecialist?"Submission Specialist":"Elite Finisher":t.isUndefeated&&t.finishRate>50?"Undefeated Finisher":t.isUndefeated?"Undefeated Prospect":t.winRate>.85&&t.totalFights>=6?"Elite Veteran":"Standard Fighter"}getMetrics(){return{...this.metrics}}}function Ce(e,t){let s=null,n=null;if(Oe(e))s="AT",n=w[s];else{const ne=t.map(de=>fe(de)),oe=Math.round(G(ne)),ce=fe(e)>=oe?"A":"P",x=t.map(Te),ae=Math.round(G(x)),le=Te(e)>=ae?"T":"NT";s=`${ce}${le}`,n=w[s]}const o=t.map(pe),i=Math.round(G(o)),r=Math.min(...o),c=Math.max(...o),a=(r+i)/2,l=(i+c)/2,h=pe(e),T=h>=i?"A":"P";let g="Muy Bajo";h>=l?g="Muy Alto":h>=i?g="Medio-Alto":h>=a&&(g="Medio-Bajo");const m=t.map(q),u=Math.round(G(m)),_=Math.min(...m),d=Math.max(...m),p=(_+u)/2,F=(u+d)/2,A=q(e),k=A>=u?"T":"NT";let f="Muy Bajo";A>=F?f="Muy Alto":A>=u?f="Medio-Alto":A>=p&&(f="Muy Bajo");let N=g==="Muy Alto"&&f==="Medio-Bajo"||g==="Medio-Alto"&&f==="Muy Alto"||g==="Medio-Bajo"&&f==="Medio-Alto"||g==="Muy Bajo"&&f==="Muy Bajo";const P=`${T}${k}`,L=w[P];N=N&&s!==P;const y=t.map(Ae),b=Math.round(G(y)),C=Math.min(...y),O=Math.max(...y),W=(C+b)/2,D=(b+O)/2,I=Ae(e),Q=I>=b?"A":"P";let S="Muy Bajo";I>=D?S="Muy Alto":I>=b?S="Medio-Alto":I>=W&&(S="Medio-Bajo");const j=t.map(Fe),E=Math.round(G(j)),Y=Math.min(...j),z=Math.max(...j),J=(Y+E)/2,Z=(E+z)/2,K=Fe(e),X=K>=E?"T":"NT";let M="Muy Bajo";K>=Z?M="Muy Alto":K>=E?M="Medio-Alto":K>=J&&(M="Muy Bajo");let $=S==="Muy Bajo"&&M==="Medio-Bajo"||S==="Medio-Bajo"&&M==="Muy Alto"||S==="Medio-Alto"&&M==="Medio-Alto"||S==="Muy Alto"&&M==="Muy Bajo";const R=`${Q}${X}`,V=w[R];$=$&&![s,P].includes(R);const ee=`${n}${N?L:""}${$?V:""}`,v=`${s}${N?`+${P}`:""}${$?`+${R}`:""}`,te=`@ARCHETYPE_${v}_DESCRIPTION`,se=`@ARCHETYPE_${v}_FAVORITE_ZONE`,ie=`@ARCHETYPE_${v}_STRENGTHS`,B=`@ARCHETYPE_${v}_WEAKNESSES`,U=v.split("+").length;return{combinedRole:v,inTransition:U>1,isDual:U===2,isTriple:U===3,archetypeEmojis:ee,description:te,favoriteZone:se,strengths:ie,weaknesses:B}}function fe(e){const t=e.Sig_Strikes_Thrown||0,s=e.Takedowns_Attempted||0,n=e.Sub_Attempts||0,o=e.Control_Time_Seconds||0,r=(e.Fight_Duration_Seconds||1)/60,c=r>0?o/r:0,a=30,l=.25,h=c>a?6:7,T=c/h,g=t+s+n+T,m=r>0?g/r:0,u=Te(e),_=q(e);let d=m*.35+u*.35+_*.3;const p=o/(t+o+1);if(p>l*1.5&&c>a*1.2){const k=Math.max(0,c/a-1),f=Math.max(0,p/l-1),N=(k+f)*2.5;d+=N}if(u>60){const k=1+(u-60)/200;d*=k}if(r<6&&_>60){const k=(6-r)/6*(_/100)*10;d+=k}const A=new Me(e).getVolumeBonuses();return d=(d+A.additive)*A.primary,Math.round(d*100)/100}function Te(e){const t=e.Sig_Strikes_Landed||0,s=e.Sig_Strikes_Thrown||0,n=e.Takedowns_Successful||0,o=e.Takedowns_Attempted||0,r=q(e)>50,c=r?.9:.85,a=r?.1:.15,l=s>0?t/s*100:0,h=o>0?n/o*100:0;let T=0;if(s>0&&o>0)T=l*c+h*a;else if(s>0)T=l;else if(o>0)T=h;else return 50;const g=e.loss_ko||0,m=e.loss_tko||0,u=e.loss_sub||0,_=e.Knockdowns_Received||0,d=e.Number_of_Fights_36m,p=d>0?(g+m+u)/d:0,F=d>0?_/d:0,A=(e.Fight_Duration_Seconds||300)/60,k=e.significant_strikes_attempted_against>0?(e.significant_strikes_attempted_against-e.Sig_Strikes_Absorbed)/e.significant_strikes_attempted_against:.6,N=A>8&&k>.6?.6:1,P=Math.min(p*1*N,.45),L=Math.min(F*.4*N,.15),y=Math.min(P+L,.55),C=new Me(e).getStrikingOffenseBonuses();if(T=(T+C.additive)*C.primary,T=T*(1-y),T>55){const O=(T-55)/45*10;T+=O}return Math.min(Math.round(T),100)}function q(e){const t=e.win||0,s=e.loss||0,n=e.draws||0,o=e.win_ko||0,i=e.win_tko||0,r=e.win_sub||0,c=t+s+n;if(c===0)return 0;let a=(o+i+r)/c*100;const l=o+i+r,h=c>0?t/c:0,T=e.Fight_Duration_Seconds>0?e.Fight_Duration_Seconds/60:15;if(T<8&&a>30){const d=Math.min((8-T)*2,8);a+=d}const g=(o>0?1:0)+(i>0?1:0)+(r>0?1:0);if(g>=2&&l>=3){const d=g*2;a+=d}const m=c>0?(o+i)/c*100:0;if(m>40){const d=Math.min((m-40)*.15,6);a+=d}const u=c>0?r/c*100:0,_=c>0?e.Sub_Attempts/c:0;if(u>20||_>1.5){const d=Math.min(u*.1+_,4);a+=d}if(h>.85&&c>=5){const d=Math.min((h-.85)*20,3);a+=d}if(e.reach_inches>72&&e.height_inches>70){const d=Math.min((e.reach_inches-72)*.1,2);a+=d}return Math.min(a,100)}function pe(e){const t=e.Knockdowns||0,s=e.Knockdowns_Received||0,n=e.Number_of_Fights_36m||1,i=(t+s)/n;let r=(1-Math.exp(-i*1.5))*100;const c=e.win||0;e.loss;const a=e.win_ko||0,l=e.win_tko||0,h=s>0?t/s:t+1;if(t>s&&t>0){const d=Math.min(h*4,12);r+=d}const T=a+l;if(T>0&&n>0){const d=T/n,p=Math.min(d*15,10);r+=p}const g=n>0?e.Sig_Strikes_Thrown/n:0;if(g>100&&t>n*.3){const d=Math.min((g-100)*.03,5);r+=d}const m=n>0?e.Sig_Strikes_Absorbed/n:0,u=n>0?c/n:0;if(m>80&&u>.7&&s<n){const d=Math.min((m-80)*.02,3);r+=d}const _=n>0?(a+l+e.win_sub)/n:0;if(_>.4&&t>=n*.2){const d=Math.min(_*8,6);r+=d}return Math.min(Math.ceil(r*100)/100,100)}function Ae(e){const s=(e.Fight_Duration_Seconds||0)/60;return Math.round(s*100)/100}function Fe(e){const t=e.Control_Time_Seconds||0,s=e.Time_Controlled_Seconds||0,n=e.Number_of_Fights_36m||1,o=(t+s)/n,i=e.Fight_Duration_Seconds||300,r=o/i*100;return Math.min(Math.round(r*100)/100,100)}const G=e=>{const t=[...e].sort((n,o)=>n-o),s=Math.floor(t.length/2);return t.length%2!==0?t[s]:(t[s-1]+t[s])/2};function Oe(e){const{win:t,loss:s,Number_of_Fights_36m:n}=e;if(n<3)return!1;const o=n>0?t/n:0,i=q(e)/100,r=(e.Fight_Duration_Seconds||300)/60,c=(s||0)===0&&t>0,a=Se(e),l=(a.STR_DEF+a.TD_DEF)/2,h=[],T=o>=.75&&i>=.6&&r<=8;h.push(T);const g=c&&t>=5&&(i>=.4||l>=75)&&r<=10;h.push(g);const m=t>0?(e.win_ko+e.win_tko)/t:0,u=(e.Knockdowns_Received||0)>0?(e.Knockdowns||0)/(e.Knockdowns_Received||1):(e.Knockdowns||0)+1,_=o>=.7&&m>=.5&&u>=2&&a.STR_DEF>=70;h.push(_);const d=e.Sig_Strikes_Thrown>0?e.Sig_Strikes_Landed/e.Sig_Strikes_Thrown:0,p=e.Takedowns_Attempted>0?e.Takedowns_Successful/e.Takedowns_Attempted:0,F=o>=.8&&d>=.45&&(p>=.4||e.Takedowns_Attempted<3)&&l>=70&&i>=.35;h.push(F);const A=n>=6,k=e.Sig_Strikes_Absorbed/Math.max(e.Number_of_Fights_36m,1)<60,f=A&&o>=.85&&k&&(i>=.3||l>=80);return h.push(f),h.some(P=>P)}function Ie(e){return Math.round(Object.values(e).reduce((t,s)=>t+s,0)/6)}function Ke(e){const t=e.win||0,s=e.loss||0,n=e.Number_of_Fights_36m||0,o=(e.win_ko||0)+(e.win_tko||0)+(e.win_sub||0),r=(e.Career_Record||"0-0-0").split("-"),c=parseInt(r[0])||0,a=parseInt(r[1])||0,l=c+a;let h=0;return n>=4&&t>=4&&s===0&&l>=15?h=12:n>=4&&t>=3&&s<=1&&l>=12?h=10:n>=3&&t>=3&&l>=20&&c>=15?h=8:n>=3&&t>=2&&s<=1&&o>=2?h=6:n>=3&&t>=2&&l>=10&&(h=4),h}function $e(e,t,s){const n=Object.values(e).reduce((r,c)=>r+c,0)/6,o=Object.values(t).reduce((r,c)=>r+c,0)/6;let i=Math.round(n*.6+o*.4);if(s){const r=s.win||0,c=(s.win_ko||0)+(s.win_tko||0)+(s.win_sub||0),l=(r>0?c/r:0)*8;i+=l;const h=Ke(s);if(i+=h,s.Number_of_Fights_36m<3)i=Math.min(i,65);else if(s.Number_of_Fights_36m===3){i=Math.min(i,70);const T=s.win||0,g=s.loss||0,m=s.draws||0,u=T+g+m,_=(s.Career_Record||"0-0-0").split("-").reduce((d,p)=>d+parseInt(p)||0,0);if(u>=3&&_>=8){const d=T/u;d>=.9?i+=6:d>=.8?i+=4:d>=.7&&(i+=2)}}else if(s.Number_of_Fights_36m>=4){const T=s.win||0,g=s.loss||0,m=s.draws||0,u=T+g+m;if(u>=4){const _=T/u;_>=.9?i+=12:_>=.8?i+=8:_>=.7?i+=5:_>=.6&&(i+=2)}}}return Math.max(0,Math.min(100,Math.round(i)))}function xe(e){return Math.round(Object.values(e).reduce((t,s)=>t+s,0)/6)}function ue(e){return e<25?1:e<35?1.5:e<45?2:e<55?2.5:e<65?3:e<75?3.5:e<85?4:e<95?4.5:5}function Ge(e,t){if(t===0)return ue(e);let s;t<5?s=.7+t*.06:s=Math.min(1.6,1+(t-5)*.12);const n=e*s;return ue(n)}function We(e){const t=e.trim().split(`
`),s=t[0].split(",").map(o=>o.replace(/"/g,"").trim()),n=[];for(let o=1;o<t.length;o++){const i=je(t[o]);if(i.length!==s.length){console.warn(`Línea ${o+1} tiene ${i.length} campos, esperados ${s.length}`);continue}const r={};s.forEach((a,l)=>{r[a]=i[l]});const c=Ue(r);c&&n.push(c)}return n}function je(e){const t=[];let s="",n=!1;for(let o=0;o<e.length;o++){const i=e[o];i==='"'?n=!n:i===","&&!n?(t.push(s.trim()),s=""):s+=i}return t.push(s.trim()),t}function Ue(e){try{const t=e.Division,s=e.Fighter;if(!t||!s)return null;const n=s.replace(/"/g,"");return{id:e.ufcstats_url&&e.ufcstats_url.split("/").pop()||"",Fighter:n,cleanName:Qe(n),Division:t,Birth_Date:e.Birth_Date||"",Career_Record:e.Career_Record||"",Sig_Strikes_Thrown:parseFloat(e.Sig_Strikes_Thrown)||0,Sig_Strikes_Landed:parseFloat(e.Sig_Strikes_Landed)||0,Sig_Strikes_Absorbed:parseFloat(e.Sig_Strikes_Absorbed)||0,Takedowns_Attempted:parseFloat(e.Takedowns_Attempted)||0,Takedowns_Successful:parseFloat(e.Takedowns_Successful)||0,Takedowns_Defended:parseFloat(e.Takedowns_Defended)||0,Sub_Attempts:parseFloat(e.Sub_Attempts)||0,Sub_Attempts_Defended:parseFloat(e.Sub_Attempts_Defended)||0,Knockdowns:parseFloat(e.Knockdowns)||0,Knockdowns_Received:parseFloat(e.Knockdowns_Received)||0,Control_Time_Seconds:parseFloat(e.Control_Time_Seconds)||0,Time_Controlled_Seconds:parseFloat(e.Time_Controlled_Seconds)||0,height_inches:parseFloat(e.height_inches)||0,reach_inches:parseFloat(e.reach_inches)||0,win:parseFloat(e.win)||0,loss:parseFloat(e.loss)||0,draws:parseFloat(e.draws)||0,win_ko:parseFloat(e.win_ko)||0,win_tko:parseFloat(e.win_tko)||0,win_sub:parseFloat(e.win_sub)||0,win_decision:parseFloat(e.win_decision)||0,loss_ko:parseFloat(e.loss_ko)||0,loss_tko:parseFloat(e.loss_tko)||0,loss_sub:parseFloat(e.loss_sub)||0,loss_decision:parseFloat(e.loss_decision)||0,Fight_Duration_Seconds:parseFloat(e.Fight_Duration_Seconds)||1,significant_strikes_attempted_against:parseFloat(e.significant_strikes_attempted_against)||0,takedowns_attempted_against:parseFloat(e.takedowns_attempted_against)||0,takedowns_allowed:parseFloat(e.takedowns_allowed)||0,submission_attempts_against:parseFloat(e.submission_attempts_against)||0,Number_of_Fights_36m:parseFloat(e.Number_of_Fights_36m)||0,Dates_36m:e.Dates_36m||"",picture_url:e.picture_url||"",ufcstats_url:e.ufcstats_url||""}}catch(t){return console.error("Error procesando luchador:",e.Fighter||e.Name,t),null}}async function He(e){const t=await fetch(e);if(!t.ok)throw new Error(`No se pudo cargar ${e}: ${t.status}`);return await t.text()}async function nt(e){try{const t=await fetch(e,{method:"HEAD"});if(!t.ok)throw new Error(`No se pudo obtener información del archivo ${e}: ${t.status}`);const s=t.headers.get("last-modified"),n=t.headers.get("content-length"),o=t.headers.get("etag");return{lastModified:s?new Date(s):null,size:n?parseInt(n,10):null,etag:o||null}}catch(t){return console.warn(`Error getting file stats for ${e}:`,t),{lastModified:null,size:null,etag:null}}}class qe{constructor(){this.allRawFightersArr=[],this.allRawFightersDataMap=new Map,this.allRawFightersByDivision=new Map,this.processedFightersMap=new Map,this.processedFighters=[],this.knownDivisions=new Set,this.cacheKey="ufc_radar_fighters_cache",this.cacheExpiryHours=24,this.fightersProcessed=!1,this.isLoading=!1,this.loadingPromise=null}saveToLocalStorage(t){try{localStorage.setItem(this.cacheKey,JSON.stringify(t))}catch(s){console.warn("Failed to save data to localStorage:",s)}}loadFromLocalStorage(){try{const t=localStorage.getItem(this.cacheKey);if(!t)return null;const s=JSON.parse(t),o=Date.now()-s.timestamp,i=this.cacheExpiryHours*60*60*1e3;return o>i?(localStorage.removeItem(this.cacheKey),null):s}catch(t){return console.warn("Failed to load data from localStorage:",t),localStorage.removeItem(this.cacheKey),null}}populateFromCache(t){this.allRawFightersArr=t.allRawFightersArr,this.allRawFightersDataMap.clear(),this.allRawFightersArr.forEach(s=>{this.allRawFightersDataMap.set(s.Fighter,s)}),this.allRawFightersByDivision.clear(),Object.entries(t.allRawFightersByDivision).forEach(([s,n])=>{this.allRawFightersByDivision.set(s,n)}),this.knownDivisions.clear(),t.knownDivisions.forEach(s=>{this.knownDivisions.add(s)}),this.processedFighters=[],this.processedFightersMap.clear(),this.allRawFightersByDivision.forEach((s,n)=>{s.forEach(o=>{const i=this.getFighterAppData(o,s);i&&(this.processedFighters.push(i),this.processedFightersMap.set(i.nameWithNickname,i))})}),this.processedFighters.sort((s,n)=>n.stars!==s.stars?n.stars-s.stars:n.overall-s.overall)}async loadFightersFromCSV(){if(this.allRawFightersDataMap.size>0&&this.fightersProcessed)return{allRawFightersArr:this.allRawFightersArr,allRawFightersDataMap:this.allRawFightersDataMap,allRawFightersByDivision:this.allRawFightersByDivision,processedFightersMap:this.processedFightersMap,processedFighters:this.processedFighters};if(this.isLoading&&this.loadingPromise)return this.loadingPromise;const t=this.loadFromLocalStorage();if(t)return this.populateFromCache(t),this.fightersProcessed=!0,{allRawFightersArr:this.allRawFightersArr,allRawFightersDataMap:this.allRawFightersDataMap,allRawFightersByDivision:this.allRawFightersByDivision,processedFightersMap:this.processedFightersMap,processedFighters:this.processedFighters};this.isLoading=!0,this.loadingPromise=this.performActualLoad();try{return await this.loadingPromise}finally{this.isLoading=!1,this.loadingPromise=null}}async performActualLoad(){try{const t=await He("data/ALL_DIVISIONS_DATA_WITH_URLS.csv");this.allRawFightersArr=We(t),this.allRawFightersArr.forEach(i=>{this.allRawFightersDataMap.has(i.Fighter)||this.allRawFightersDataMap.set(i.Fighter,i),this.allRawFightersByDivision.has(i.Division)?this.allRawFightersByDivision.get(i?.Division)?.push(i):this.allRawFightersByDivision.set(i.Division,[i])}),this.allRawFightersByDivision.forEach((i,r)=>{i.forEach(c=>{const a=this.getFighterAppData(c,i);a&&(this.processedFighters.push(a),this.processedFightersMap.set(a.nameWithNickname,a))})}),this.processedFighters.forEach(i=>{const r=De(i.rawData.Dates_36m);if(r.length>0){const c=[];r.forEach(a=>{const l=this.getFighterById(a.fighterId);l&&a.result&&c.push({opponent:{overall:l.overall},result:a.result,method:void 0,monthsAgo:a.monthsAgo})}),i.oppTierScore=Ze(c)}else i.oppTierScore=0}),this.processedFighters.forEach(i=>{i.stars=Ge(i.overall,i.oppTierScore)}),this.processedFighters.sort((i,r)=>r.stars!==i.stars?r.stars-i.stars:r.overall-i.overall);const s=new Map,n=new Map;this.processedFighters.forEach(i=>{s.set(i.nameWithNickname,i.stars),n.set(i.nameWithNickname,i.overall)}),this.allRawFightersArr.sort((i,r)=>{const c=s.get(i.Fighter)??0,a=s.get(r.Fighter)??0,l=n.get(i.Fighter)??0,h=n.get(r.Fighter)??0;return a!==c?a-c:h-l}),this.allRawFightersByDivision.forEach((i,r)=>{i.sort((c,a)=>{const l=s.get(c.Fighter)??0,h=s.get(a.Fighter)??0,T=n.get(c.Fighter)??0,g=n.get(a.Fighter)??0;return h!==l?h-l:g-T})}),this.knownDivisions.clear(),this.allRawFightersArr.forEach(i=>{const r=i.Division.toLowerCase();this.knownDivisions.add(r),this.knownDivisions.add(r.replace(/ /g,"_")),this.knownDivisions.add(r.replace(/women's\s+/g,"w_")),this.knownDivisions.add(r.replace(/w_/g,"women's "))});const o={timestamp:Date.now(),allRawFightersArr:this.allRawFightersArr,allRawFightersByDivision:Object.fromEntries(this.allRawFightersByDivision),knownDivisions:Array.from(this.knownDivisions)};return this.saveToLocalStorage(o),this.fightersProcessed=!0,{allRawFightersArr:this.allRawFightersArr,allRawFightersDataMap:this.allRawFightersDataMap,allRawFightersByDivision:this.allRawFightersByDivision,processedFightersMap:this.processedFightersMap,processedFighters:this.processedFighters}}catch(t){return console.error("Error loading fighters:",t),{allRawFightersArr:this.allRawFightersArr,allRawFightersDataMap:this.allRawFightersDataMap,allRawFightersByDivision:this.allRawFightersByDivision,processedFightersMap:this.processedFightersMap,processedFighters:this.processedFighters}}}calculateSyntheticFighter(t,s){return this.getFighterAppData(t,s)}getFighterAppData(t,s){try{const n=Se(t),o=Ce(t,s),i=Le(t,o),r=$e(n,i,t),c=ue(r);return{id:t.id,name:t.cleanName,nameWithNickname:t.Fighter,division:t.Division,birthDate:Ve(t.Birth_Date),age:Xe(t.Birth_Date),career_record:t.Career_Record||"TBD",record_36m:`${t.win}-${t.loss}-${t.draws}`,pictureUrl:t.picture_url||"",ufcstats_url:t.ufcstats_url||"",fightRadar:n,iqRadar:i,archetype:o,stars:c,performance:Ie(n),overall:r,fightIQ:xe(i),oppTierScore:0,rawData:t}}catch(n){return console.error("Error processing fighter:",t.Fighter,n),null}}searchFighterByNameAndNickname(t,s=20){const n=this.processedFighters,o=H(t);return n.find(i=>H(i.nameWithNickname)===o)??null}searchFightersByDivision(t){const s=this.processedFighters,n=H(t),o=H(n.replace(/womens\s+/g,"w"));return this.knownDivisions.has(n)||this.knownDivisions.has(o)?s.filter(c=>{const a=H(c.division);return a===n||a===o}):[]}getFighterById(t){return this.processedFighters.find(n=>n.id===t)||null}}const ke=new qe,w={AT:"🔴",ANT:"🟡",PT:"🔵",PNT:"🟢"};function Ne(e){const t=ge(Be)||"es",s={en:{AT:"The Strategist",ANT:"The Predator",PT:"The Sniper",PNT:"The Shield","ANT+AT":"The Whirlwind","AT+ANT":"The Hurricane","AT+PNT":"The Guardian","AT+PT":"The Surgeon","PNT+AT":"The Technical Bastion","PT+AT":"The Pulse Master","ANT+PNT":"The Beast","ANT+PT":"The Punisher","PNT+ANT":"The Feral","PT+ANT":"The Silent Demolisher","PNT+PT":"The Anchor","PT+PNT":"The Wall","ANT+AT+PNT":"The Center Colossus","ANT+AT+PT":"The Wild Strategist","ANT+PNT+AT":"","ANT+PT+AT":"The Incursor","AT+ANT+PNT":"The Unbreakable","AT+ANT+PT":"The Chaos Architect","AT+PNT+ANT":"The Technical Lion","AT+PNT+PT":"The Wall Warrior","AT+PT+ANT":"The Rhythm Alchemist","AT+PT+PNT":"The Iron Sage","PNT+ANT+AT":"The Chaos Phoenix","PNT+AT+ANT":"The Legionnaire","PNT+AT+PT":"The Steel Sentinel","PNT+PT+AT":"The Rhythm Bastion","PT+ANT+AT":"The Combat Constructor","PT+AT+ANT":"The Tactical Strangler","PT+AT+PNT":"The Armored Tactical","PT+PNT+AT":"The Cage Monk","ANT+PNT+PT":"The Unstoppable Cyclone","ANT+PT+PNT":"The Wild Gladiator","PNT+ANT+PT":"The Iron Hammer","PNT+PT+ANT":"The Wild Colossus","PT+ANT+PNT":"The Octagon Barbarian","PT+PNT+ANT":"The Silent Titan"},es:{AT:"El Estratega",ANT:"El Depredador",PT:"El Francotirador",PNT:"El Escudo","ANT+AT":"El Vendaval","AT+ANT":"El Huracán","AT+PNT":"El Guardián","AT+PT":"El Cirujano","PNT+AT":"El Bastión Técnico","PT+AT":"El Maestro del Pulso","ANT+PNT":"La Bestia","ANT+PT":"El Castigador","PNT+ANT":"El Feral","PT+ANT":"El Demoledor Silencioso","PNT+PT":"El Ancla","PT+PNT":"La Muralla","ANT+AT+PNT":"El Coloso del Centro","ANT+AT+PT":"El Estratega Salvaje","ANT+PNT+AT":"","ANT+PT+AT":"El Incursor","AT+ANT+PNT":"El Inquebrantable","AT+ANT+PT":"El Arquitecto del Caos","AT+PNT+ANT":"El León Técnico","AT+PNT+PT":"El Guerrero del Muro","AT+PT+ANT":"El Alquimista del Ritmo","AT+PT+PNT":"El Sabio de Hierro","PNT+ANT+AT":"El Fénix del Caos","PNT+AT+ANT":"El Legionario","PNT+AT+PT":"El Centinela de Acero","PNT+PT+AT":"El Bastión del Ritmo","PT+ANT+AT":"El Constructor del Combate","PT+AT+ANT":"El Estrangulador Táctico","PT+AT+PNT":"El Táctico Blindado","PT+PNT+AT":"El Monje de la Jaula","ANT+PNT+PT":"El Ciclón Imparable","ANT+PT+PNT":"El Gladiador Salvaje","PNT+ANT+PT":"El Martillo de Hierro","PNT+PT+ANT":"El Coloso Salvaje","PT+ANT+PNT":"El Bárbaro del Octágono","PT+PNT+ANT":"El Titán Silencioso"},fr:{AT:"Le Stratège",ANT:"Le Prédateur",PT:"Le Sniper",PNT:"Le Bouclier","ANT+AT":"Le Tourbillon","AT+ANT":"L'Ouragan","AT+PNT":"Le Gardien","AT+PT":"Le Chirurgien","PNT+AT":"Le Bastion Technique","PT+AT":"Le Maître du Pouls","ANT+PNT":"La Bête","ANT+PT":"Le Punisseur","PNT+ANT":"Le Féral","PT+ANT":"Le Démolisseur Silencieux","PNT+PT":"L'Ancre","PT+PNT":"Le Mur","ANT+AT+PNT":"Le Colosse du Centre","ANT+AT+PT":"Le Stratège Sauvage","ANT+PNT+AT":"","ANT+PT+AT":"L'Incurseur","AT+ANT+PNT":"L'Incassable","AT+ANT+PT":"L'Architecte du Chaos","AT+PNT+ANT":"Le Lion Technique","AT+PNT+PT":"Le Guerrier du Mur","AT+PT+ANT":"L'Alchimiste du Rythme","AT+PT+PNT":"Le Sage de Fer","PNT+ANT+AT":"Le Phénix du Chaos","PNT+AT+ANT":"Le Légionnaire","PNT+AT+PT":"La Sentinelle d'Acier","PNT+PT+AT":"Le Bastion du Rythme","PT+ANT+AT":"Le Constructeur de Combat","PT+AT+ANT":"L'Étrangleur Tactique","PT+AT+PNT":"Le Tactique Blindé","PT+PNT+AT":"Le Moine de la Cage","ANT+PNT+PT":"Le Cyclone Imparable","ANT+PT+PNT":"Le Gladiateur Sauvage","PNT+ANT+PT":"Le Marteau de Fer","PNT+PT+ANT":"Le Colosse Sauvage","PT+ANT+PNT":"Le Barbare de l'Octogone","PT+PNT+ANT":"Le Titan Silencieux"},pt:{AT:"O Estrategista",ANT:"O Predador",PT:"O Atirador",PNT:"O Escudo","ANT+AT":"O Vendaval","AT+ANT":"O Furacão","AT+PNT":"O Guardião","AT+PT":"O Cirurgião","PNT+AT":"O Bastião Técnico","PT+AT":"O Mestre do Pulso","ANT+PNT":"A Fera","ANT+PT":"O Castigador","PNT+ANT":"O Feral","PT+ANT":"O Demolidor Silencioso","PNT+PT":"A Âncora","PT+PNT":"A Muralha","ANT+AT+PNT":"O Colosso do Centro","ANT+AT+PT":"O Estrategista Selvagem","ANT+PNT+AT":"","ANT+PT+AT":"O Incursor","AT+ANT+PNT":"O Inquebrantável","AT+ANT+PT":"O Arquiteto do Caos","AT+PNT+ANT":"O Leão Técnico","AT+PNT+PT":"O Guerreiro do Muro","AT+PT+ANT":"O Alquimista do Ritmo","AT+PT+PNT":"O Sábio de Ferro","PNT+ANT+AT":"A Fênix do Caos","PNT+AT+ANT":"O Legionário","PNT+AT+PT":"O Sentinela de Aço","PNT+PT+AT":"O Bastião do Ritmo","PT+ANT+AT":"O Construtor de Combate","PT+AT+ANT":"O Estrangulador Tático","PT+AT+PNT":"O Tático Blindado","PT+PNT+AT":"O Monge da Jaula","ANT+PNT+PT":"O Ciclone Imparável","ANT+PT+PNT":"O Gladiador Selvagem","PNT+ANT+PT":"O Martelo de Ferro","PNT+PT+ANT":"O Colosso Selvagem","PT+ANT+PNT":"O Bárbaro do Octógono","PT+PNT+ANT":"O Titã Silencioso"}};return(s[t]||s.es)[e]||e}function ot(e){if(!e)return{type:"loading",label:"⭕",name:"Analizando...",tooltip:"Calculando arquetipo..."};const t=[],s=e.combinedRole.split("+"),[n,o,i]=s;[n,o,i].filter(c=>!!c).forEach(c=>{const a=Ne(c),l=w[c];t.push(`${l} ${a}`)}),e.inTransition&&t.push("En transición");const r=t.join(`
`);return{type:e.isTriple?"triple":e.isDual?"dual":"single",label:`${w[n]}${o?w[o]:""}${i?w[i]:""}`,name:Ne(e.inTransition?e.combinedRole:n),tooltip:r}}function rt(e,t){if(t.length===0)throw new Error(`No fighters data provided for division: ${e}`);const s=t.length,n=t.reduce((o,i)=>(o.Sig_Strikes_Thrown+=i.Sig_Strikes_Thrown,o.Sig_Strikes_Landed+=i.Sig_Strikes_Landed,o.Sig_Strikes_Absorbed+=i.Sig_Strikes_Absorbed,o.Takedowns_Attempted+=i.Takedowns_Attempted,o.Takedowns_Successful+=i.Takedowns_Successful,o.Takedowns_Defended+=i.Takedowns_Defended,o.Sub_Attempts+=i.Sub_Attempts,o.Sub_Attempts_Defended+=i.Sub_Attempts_Defended,o.Knockdowns+=i.Knockdowns,o.Knockdowns_Received+=i.Knockdowns_Received,o.Control_Time_Seconds+=i.Control_Time_Seconds,o.Time_Controlled_Seconds+=i.Time_Controlled_Seconds,o.height_inches+=i.height_inches,o.reach_inches+=i.reach_inches,o.win+=i.win,o.loss+=i.loss,o.draws+=i.draws,o.win_ko+=i.win_ko,o.win_tko+=i.win_tko,o.win_sub+=i.win_sub,o.win_decision+=i.win_decision,o.loss_ko+=i.loss_ko,o.loss_tko+=i.loss_tko,o.loss_sub+=i.loss_sub,o.loss_decision+=i.loss_decision,o.Fight_Duration_Seconds+=i.Fight_Duration_Seconds,o.significant_strikes_attempted_against+=i.significant_strikes_attempted_against,o.takedowns_attempted_against+=i.takedowns_attempted_against,o.takedowns_allowed+=i.takedowns_allowed,o.submission_attempts_against+=i.submission_attempts_against,o.Number_of_Fights_36m+=i.Number_of_Fights_36m,o),{Sig_Strikes_Thrown:0,Sig_Strikes_Landed:0,Sig_Strikes_Absorbed:0,Takedowns_Attempted:0,Takedowns_Successful:0,Takedowns_Defended:0,Sub_Attempts:0,Sub_Attempts_Defended:0,Knockdowns:0,Knockdowns_Received:0,Control_Time_Seconds:0,Time_Controlled_Seconds:0,height_inches:0,reach_inches:0,win:0,loss:0,draws:0,win_ko:0,win_tko:0,win_sub:0,win_decision:0,loss_ko:0,loss_tko:0,loss_sub:0,loss_decision:0,Fight_Duration_Seconds:0,significant_strikes_attempted_against:0,takedowns_attempted_against:0,takedowns_allowed:0,submission_attempts_against:0,Number_of_Fights_36m:0});return{id:"",Fighter:`${e} Average`,cleanName:`${e} Average`,Division:e,Birth_Date:"",Career_Record:"",Sig_Strikes_Thrown:n.Sig_Strikes_Thrown/s,Sig_Strikes_Landed:n.Sig_Strikes_Landed/s,Sig_Strikes_Absorbed:n.Sig_Strikes_Absorbed/s,Takedowns_Attempted:n.Takedowns_Attempted/s,Takedowns_Successful:n.Takedowns_Successful/s,Takedowns_Defended:n.Takedowns_Defended/s,Sub_Attempts:n.Sub_Attempts/s,Sub_Attempts_Defended:n.Sub_Attempts_Defended/s,Knockdowns:n.Knockdowns/s,Knockdowns_Received:n.Knockdowns_Received/s,Control_Time_Seconds:n.Control_Time_Seconds/s,Time_Controlled_Seconds:n.Time_Controlled_Seconds/s,height_inches:n.height_inches/s,reach_inches:n.reach_inches/s,win:n.win/s,loss:n.loss/s,draws:n.draws/s,win_ko:n.win_ko/s,win_tko:n.win_tko/s,win_sub:n.win_sub/s,win_decision:n.win_decision/s,loss_ko:n.loss_ko/s,loss_tko:n.loss_tko/s,loss_sub:n.loss_sub/s,loss_decision:n.loss_decision/s,Fight_Duration_Seconds:n.Fight_Duration_Seconds/s,significant_strikes_attempted_against:n.significant_strikes_attempted_against/s,takedowns_attempted_against:n.takedowns_attempted_against/s,takedowns_allowed:n.takedowns_allowed/s,submission_attempts_against:n.submission_attempts_against/s,Number_of_Fights_36m:n.Number_of_Fights_36m/s,Dates_36m:"",picture_url:"",ufcstats_url:""}}function H(e){return!e||typeof e!="string"?"":e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z0-9]/g,"").trim()}function ct(e){return!e||typeof e!="string"?"":e.replace(/W_/g,"Women's ").replace(/_/g," ")}function De(e){if(!e||e==="N/A")return[];const t=e.split(",").map(n=>n.trim()).filter(n=>n),s=new Date;return t.map(n=>{let o,i,r,c="";if(n.includes(":")){const u=n.split(":"),_=u[0];c=u[1]||"";let d="";if(u.length>=3&&(d=u[2]),_.includes("-")){const[p,F,A]=_.split("-");o=F,i=A,r=new Date(parseInt(A),parseInt(F)-1,parseInt(p))}else[o,i]=_.split("/"),r=new Date(2e3+parseInt(i),parseInt(o)-1);d&&(c+=`|${d}`)}else[o,i]=n.split("/"),r=new Date(2e3+parseInt(i),parseInt(o)-1);let a="",l=c;if(c.includes("|")){const u=c.split("|");l=u[0],a=u[1]}if(!o||!i)return{original:n,monthsAgo:0,fighterId:l,fighter:ke.getFighterById(l),dateString:n,result:a||void 0};const h=s.getTime()-r.getTime(),T=Math.floor(h/(1e3*60*60*24*30.44)),g=String(o).padStart(2,"0"),m=i.length===4?i.slice(2):i;return{original:`${g}/${m}`,monthsAgo:Math.max(0,T),fighterId:l,fighter:ke.getFighterById(l),dateString:`${g}/${m}`,result:a||void 0}}).sort((n,o)=>n.monthsAgo-o.monthsAgo)}function Qe(e){return!e||typeof e!="string"?"":e.replace(/\s*\([^)]*\)\s*/g,"").trim()}function Ye(e){return e>=85?"ELITE":e>=75?"CONTENDER":e>=65?"SOLID":e>=50?"MEDIOCRE":"TERRIBLE"}const ze={ELITE:{W:10,L:7,D:8,NC:0},CONTENDER:{W:8,L:5,D:6,NC:0},SOLID:{W:6,L:3,D:4,NC:0},MEDIOCRE:{W:4,L:1,D:2,NC:0},TERRIBLE:{W:2,L:0,D:1,NC:0}};function Je(e,t){if(e!=="W"||!t)return 1;switch(t.toUpperCase()){case"KO":case"TKO":case"KO/TKO":return 1.3;case"SUB":case"SUBMISSION":return 1.2;case"DEC":case"DECISION":return 1;default:return 1}}function Ze(e){if(!e||e.length===0)return 0;let t=0,s=0;if(e.forEach(i=>{if(!i.opponent||typeof i.opponent.overall!="number")return;const r=Ye(i.opponent.overall),c=ze[r]?.[i.result]??0,a=Je(i.result,i.method),l=c*a;t+=l,s++}),s===0)return 0;const n=t/s,o=Math.max(0,Math.min(10,n));return Math.round(o*100)/100}function Re(e){if(!e||e.trim()==="")return null;const t=/^(\d{1,2})-(\d{1,2})-(\d{4})$/,s=e.match(t);if(s){const[,n,o,i]=s,r=new Date(parseInt(i),parseInt(o)-1,parseInt(n));if(r.getDate()===parseInt(n)&&r.getMonth()===parseInt(o)-1&&r.getFullYear()===parseInt(i))return r}return null}function Xe(e){if(!e||e.trim()==="")return 0;const t=Re(e);if(!t)return 0;const s=new Date;let n=s.getFullYear()-t.getFullYear();const o=s.getMonth()-t.getMonth();return(o<0||o===0&&s.getDate()<t.getDate())&&n--,Math.max(0,n)}function Ve(e){if(!e||e.trim()==="")return"";const t=Re(e);if(!t)return e;const s=t.getDate().toString().padStart(2,"0"),n=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getFullYear();return`${s}/${n}/${o}`}export{rt as a,ct as b,H as c,st as d,it as e,ke as f,ot as g,nt as h,De as p};
