import{q,f as D,c as l,t as b,y as u,b as E,o as B,a as ee,p as I,F as te,C as m,z as L,j as ae,u as v,A as _,K as re,i as W,x as y,J as se,a3 as ne,I as ie}from"./lucide-CFoebsfS.js";import{n as le,p as oe,$ as ce}from"./index-DFQZKW-T.js";import{C as ve,i as de}from"./fullcalendar-YnvH41mY.js";import{H as ue}from"./Header-tZijFwiS.js";import"./highcharts-DyRVWUji.js";function fe(f,n){le(n.path)}var he=D('<div class="nav-breadcrumb svelte-1xign5y"><button class="breadcrumb-link svelte-1xign5y"> </button></div>');function ge(f,n){q(n,!0);var h=he(),g=l(h);g.__click=[fe,n];var i=l(g);b(()=>u(i,n.text)),E(f,h),B()}ee(["click"]);var pe=D('<div class="loading svelte-2p0jch" id="loading"><div class="loading-content svelte-2p0jch"><div class="spinner svelte-2p0jch"></div> <p class="svelte-2p0jch"> </p></div></div>'),me=D('<div class="error-message svelte-2p0jch" id="error-message"> </div>'),_e=D('<div class="calendar-page svelte-2p0jch"><!> <!> <div class="calendar-header svelte-2p0jch"><h1 class="svelte-2p0jch"> </h1> <p class="svelte-2p0jch"> </p></div> <!> <!> <div id="calendar" class="calendar-component svelte-2p0jch"></div></div>');function xe(f,n){q(n,!1);const[h,g]=ie(),i=()=>se(ce,"$_",h);let H=I(n,"isDarkMode",8,!0),R=I(n,"toggleTheme",8,()=>{}),d=null,k=[],w=L(!1),p=L("");te(async()=>{await z(),await C()});async function z(){const e=document.getElementById("calendar");e&&(d=new ve(e,{plugins:[de],initialView:"dayGridMonth",firstDay:1,headerToolbar:{left:"prev,next today",right:"title"},events:[],eventDisplay:"block",eventColor:"var(--event-color)",height:"auto",eventTimeFormat:{hour:"numeric",minute:"2-digit",meridiem:"short"},eventClick:t=>{O(t)}}),d.render())}async function C(){try{m(w,!0),m(p,""),k=await G(),d&&(d.removeAllEvents(),d.addEventSource(k))}catch(e){console.error("Error loading calendar events:",e),m(p,"Error loading UFC events. CORS restrictions may apply. Try running from a local server.")}finally{m(w,!1)}}async function G(){const e="https://raw.githubusercontent.com/clarencechaan/ufc-cal/ics/UFC.ics";try{const t=await fetch(e);if(t.ok){const s=await t.text();return $(s)}else throw new Error("Direct fetch failed")}catch{try{const s=await oe.fetchCalendar(e);return $(s)}catch{throw new Error("All fetch methods failed")}}}function $(e){const t=[],s=e.split(`
`);let a={},c=!1;for(let r of s)if(r=r.trim(),r==="BEGIN:VEVENT")c=!0,a={};else if(r==="END:VEVENT"&&c){if(a.title&&a.start){const[o,S]=a.title.split(": ");t.push({title:S??o,start:a.start,end:a.end,allDay:a.allDay,color:"var(--event-color)"})}c=!1}else if(c){if(r.startsWith("SUMMARY:"))a.title=r.substring(8);else if(r.startsWith("DTSTART")){const o=r.split(":")[1];r.includes("VALUE=DATE")?(a.start=x(o),a.allDay=!0):(a.start=j(o),a.allDay=!1)}else if(r.startsWith("DTEND")){const o=r.split(":")[1];r.includes("VALUE=DATE")?a.end=x(o):a.end=j(o)}}return t}function j(e){if(e.length===8)return x(e);const t=e.substring(0,4),s=e.substring(4,6),a=e.substring(6,8),c=e.substring(9,11)||"00",r=e.substring(11,13)||"00",o=e.substring(13,15)||"00";return`${t}-${s}-${a}T${c}:${r}:${o}`}function x(e){const t=e.substring(0,4),s=e.substring(4,6),a=e.substring(6,8);return`${t}-${s}-${a}`}function O(e){window?.open(`https://www.google.com/search?q=${e.event.title} ${e.event.start?.toLocaleDateString()}`,"_blank")?.focus()}async function T(){await C()}ae();var A=_e(),V=l(A);ue(V,{showThemeToggle:!0,get isDarkMode(){return H()},get toggleTheme(){return R()}});var M=v(V,2);{let e=re(()=>(i(),y(()=>i()("calendar_page.back_to_radar"))));ge(M,{get text(){return _(e)},path:"/"})}var U=v(M,2),F=l(U),J=l(F),K=v(F,2),P=l(K),N=v(U,2);{var Y=e=>{var t=pe(),s=l(t),a=v(l(s),2),c=l(a);b(r=>u(c,r),[()=>(i(),y(()=>i()("calendar_page.loading")))]),E(e,t)};W(N,e=>{_(w)&&e(Y)})}var Q=v(N,2);{var X=e=>{var t=me(),s=l(t);b(()=>u(s,_(p))),E(e,t)};W(Q,e=>{_(p)&&e(X)})}b((e,t)=>{u(J,e),u(P,t)},[()=>(i(),y(()=>i()("calendar_page.title"))),()=>(i(),y(()=>i()("calendar_page.subtitle")))]),E(f,A),ne(n,"refreshEvents",T);var Z=B({refreshEvents:T});return g(),Z}export{xe as default};
