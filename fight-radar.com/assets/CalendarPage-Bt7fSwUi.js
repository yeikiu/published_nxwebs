import{o as M,f as p,c as g,t as F,x as L,a as h,n as N,d as P,p as j,y as q,D as f,E as V,h as z,r as E,i as A,B as b,_ as Y}from"./lucide-DhWK0f18.js";import{C as J,i as K}from"./fullcalendar-YnvH41mY.js";import{H as Q}from"./Header-Dis0PFim.js";import{r as X}from"./index-CD6uLsQd.js";function Z(c,i){X.navigate(i.path)}var S=p('<div class="nav-breadcrumb svelte-1xign5y"><button class="breadcrumb-link svelte-1xign5y"> </button></div>');function ee(c,i){M(i,!0);var d=S(),v=g(d);v.__click=[Z,i];var l=g(v);F(()=>L(l,i.text)),h(c,d),N()}P(["click"]);var te=p('<div class="loading svelte-2p0jch" id="loading"><div class="loading-content svelte-2p0jch"><div class="spinner svelte-2p0jch"></div> <p class="svelte-2p0jch">Loading UFC events...</p></div></div>'),ae=p('<div class="error-message svelte-2p0jch" id="error-message"> </div>'),re=p('<div class="calendar-page svelte-2p0jch"><!> <!> <div class="calendar-header svelte-2p0jch"><h1 class="svelte-2p0jch">UFC Event Calendar</h1> <p class="svelte-2p0jch">Upcoming and past UFC events</p></div> <!> <!> <div id="calendar" class="calendar-component svelte-2p0jch"></div></div>');function le(c,i){M(i,!1);let d=j(i,"isDarkMode",8,!0),v=j(i,"toggleTheme",8,()=>{}),l=null,w=[],m=V(!1),u=V("");q(async()=>{await R(),await D()});async function R(){const e=document.getElementById("calendar");e&&(l=new J(e,{plugins:[K],initialView:"dayGridMonth",firstDay:1,headerToolbar:{left:"prev,next today",right:"title"},events:[],eventDisplay:"block",eventColor:"var(--event-color)",height:"auto",eventTimeFormat:{hour:"numeric",minute:"2-digit",meridiem:"short"},eventClick:t=>{W(t)}}),l.render())}async function D(){try{f(m,!0),f(u,""),w=await B(),l&&(l.removeAllEvents(),l.addEventSource(w))}catch(e){console.error("Error loading calendar events:",e),f(u,"Error loading UFC events. CORS restrictions may apply. Try running from a local server.")}finally{f(m,!1)}}async function B(){const e="https://raw.githubusercontent.com/clarencechaan/ufc-cal/ics/UFC.ics";let t,n;try{if(t=await fetch(e),t.ok)n=await t.text();else throw new Error("Direct fetch failed")}catch{console.log("Direct fetch failed, trying proxy...");const o=["https://api.allorigins.win/raw?url=","https://cors-anywhere.herokuapp.com/"];for(const r of o)try{if(t=await fetch(r+encodeURIComponent(e)),t.ok){n=await t.text();break}}catch(s){console.log(`Proxy ${r} failed:`,s)}if(!n)throw new Error("All fetch methods failed")}return I(n)}function I(e){const t=[],n=e.split(`
`);let a={},o=!1;for(let r of n)if(r=r.trim(),r==="BEGIN:VEVENT")o=!0,a={};else if(r==="END:VEVENT"&&o){if(a.title&&a.start){const[s,O]=a.title.split(": ");t.push({title:O??s,start:a.start,end:a.end,allDay:a.allDay,color:"var(--event-color)"})}o=!1}else if(o){if(r.startsWith("SUMMARY:"))a.title=r.substring(8);else if(r.startsWith("DTSTART")){const s=r.split(":")[1];r.includes("VALUE=DATE")?(a.start=y(s),a.allDay=!0):(a.start=x(s),a.allDay=!1)}else if(r.startsWith("DTEND")){const s=r.split(":")[1];r.includes("VALUE=DATE")?a.end=y(s):a.end=x(s)}}return t}function x(e){if(e.length===8)return y(e);const t=e.substring(0,4),n=e.substring(4,6),a=e.substring(6,8),o=e.substring(9,11)||"00",r=e.substring(11,13)||"00",s=e.substring(13,15)||"00";return`${t}-${n}-${a}T${o}:${r}:${s}`}function y(e){const t=e.substring(0,4),n=e.substring(4,6),a=e.substring(6,8);return`${t}-${n}-${a}`}function W(e){window?.open(`https://www.google.com/search?q=${e.event.title} ${e.event.start?.toLocaleDateString()}`,"_blank")?.focus()}async function _(){await D()}z();var C=re(),k=g(C);Q(k,{showThemeToggle:!0,get isDarkMode(){return d()},get toggleTheme(){return v()}});var U=E(k,2);ee(U,{text:"← Volver al Radar de Luchadores",path:"/"});var T=E(U,4);{var $=e=>{var t=te();h(e,t)};A(T,e=>{b(m)&&e($)})}var G=E(T,2);{var H=e=>{var t=ae(),n=g(t);F(()=>L(n,b(u))),h(e,t)};A(G,e=>{b(u)&&e(H)})}return h(c,C),Y(i,"refreshEvents",_),N({refreshEvents:_})}export{le as default};
