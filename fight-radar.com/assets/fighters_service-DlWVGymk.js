import{aP as gt}from"./lucide-CFoebsfS.js";import{$ as mt}from"./index-DpD7lEH3.js";function Et(t){return!t||typeof t!="string"?"":t.replace(/\s*\([^)]*\)\s*/g,"").trim()}function se(t){if(!t||typeof t!="string")return null;const e=t.match(/\(([^)]+)\)/);return e?e[1]:null}function U(t){return!t||typeof t!="string"?"":t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z0-9]/g,"").trim()}const b={AT:"ðŸ”´",ANT:"ðŸŸ¡",PT:"ðŸ”µ",PNT:"ðŸŸ¢"};function ie(t){if(!t)return{type:"loading",label:"â­•",name:"Analizando...",tooltip:"Calculando arquetipo..."};const e=gt(mt),s=[],n=t.combinedRole.split("+"),[i,o,r]=n;[i,o,r].filter(a=>!!a).forEach(a=>{const l=e(`role_disc_modal.archetype_names.${a}`),d=b[a];s.push(`${d} ${l}`)}),t.inTransition&&s.push("En transiciÃ³n");const c=s.join(`
`);return{type:t.isTriple?"triple":t.isDual?"dual":"single",label:`${b[i]}${o?b[o]:""}${r?b[r]:""}`,name:e(`role_disc_modal.archetype_names.${t.inTransition?t.combinedRole:i}`),tooltip:c}}function ne(t,e){if(e.length===0)throw new Error(`No fighters data provided for division: ${t}`);const s=e.length,n=e.reduce((i,o)=>(i.Sig_Strikes_Thrown+=o.Sig_Strikes_Thrown,i.Sig_Strikes_Landed+=o.Sig_Strikes_Landed,i.Sig_Strikes_Absorbed+=o.Sig_Strikes_Absorbed,i.Takedowns_Attempted+=o.Takedowns_Attempted,i.Takedowns_Successful+=o.Takedowns_Successful,i.Takedowns_Defended+=o.Takedowns_Defended,i.Sub_Attempts+=o.Sub_Attempts,i.Sub_Attempts_Defended+=o.Sub_Attempts_Defended,i.Knockdowns+=o.Knockdowns,i.Knockdowns_Received+=o.Knockdowns_Received,i.Control_Time_Seconds+=o.Control_Time_Seconds,i.Time_Controlled_Seconds+=o.Time_Controlled_Seconds,i.height_inches+=o.height_inches,i.reach_inches+=o.reach_inches,i.win+=o.win,i.loss+=o.loss,i.draws+=o.draws,i.win_ko+=o.win_ko,i.win_tko+=o.win_tko,i.win_sub+=o.win_sub,i.win_decision+=o.win_decision,i.loss_ko+=o.loss_ko,i.loss_tko+=o.loss_tko,i.loss_sub+=o.loss_sub,i.loss_decision+=o.loss_decision,i.Fight_Duration_Seconds+=o.Fight_Duration_Seconds,i.significant_strikes_attempted_against+=o.significant_strikes_attempted_against,i.takedowns_attempted_against+=o.takedowns_attempted_against,i.takedowns_allowed+=o.takedowns_allowed,i.submission_attempts_against+=o.submission_attempts_against,i.Number_of_Fights_36m+=o.Number_of_Fights_36m,i),{Sig_Strikes_Thrown:0,Sig_Strikes_Landed:0,Sig_Strikes_Absorbed:0,Takedowns_Attempted:0,Takedowns_Successful:0,Takedowns_Defended:0,Sub_Attempts:0,Sub_Attempts_Defended:0,Knockdowns:0,Knockdowns_Received:0,Control_Time_Seconds:0,Time_Controlled_Seconds:0,height_inches:0,reach_inches:0,win:0,loss:0,draws:0,win_ko:0,win_tko:0,win_sub:0,win_decision:0,loss_ko:0,loss_tko:0,loss_sub:0,loss_decision:0,Fight_Duration_Seconds:0,significant_strikes_attempted_against:0,takedowns_attempted_against:0,takedowns_allowed:0,submission_attempts_against:0,Number_of_Fights_36m:0});return{id:"",Fighter:`${t} Average`,cleanName:`${t} Average`,Division:t,Birth_Date:"",Career_Record:"",Sig_Strikes_Thrown:n.Sig_Strikes_Thrown/s,Sig_Strikes_Landed:n.Sig_Strikes_Landed/s,Sig_Strikes_Absorbed:n.Sig_Strikes_Absorbed/s,Takedowns_Attempted:n.Takedowns_Attempted/s,Takedowns_Successful:n.Takedowns_Successful/s,Takedowns_Defended:n.Takedowns_Defended/s,Sub_Attempts:n.Sub_Attempts/s,Sub_Attempts_Defended:n.Sub_Attempts_Defended/s,Knockdowns:n.Knockdowns/s,Knockdowns_Received:n.Knockdowns_Received/s,Control_Time_Seconds:n.Control_Time_Seconds/s,Time_Controlled_Seconds:n.Time_Controlled_Seconds/s,height_inches:n.height_inches/s,reach_inches:n.reach_inches/s,win:n.win/s,loss:n.loss/s,draws:n.draws/s,win_ko:n.win_ko/s,win_tko:n.win_tko/s,win_sub:n.win_sub/s,win_decision:n.win_decision/s,loss_ko:n.loss_ko/s,loss_tko:n.loss_tko/s,loss_sub:n.loss_sub/s,loss_decision:n.loss_decision/s,Fight_Duration_Seconds:n.Fight_Duration_Seconds/s,significant_strikes_attempted_against:n.significant_strikes_attempted_against/s,takedowns_attempted_against:n.takedowns_attempted_against/s,takedowns_allowed:n.takedowns_allowed/s,submission_attempts_against:n.submission_attempts_against/s,Number_of_Fights_36m:n.Number_of_Fights_36m/s,Dates_36m:"",picture_url:"",ufcstats_url:""}}function oe(t){return!t||typeof t!="string"?"":t.replace(/W_/g,"Women's ").replace(/_/g," ")}function re(t,e){if(!t||t==="N/A")return[];const s=t.split(",").map(i=>i.trim()).filter(i=>i),n=new Date;return s.map(i=>{let o,r,c,a="";if(i.includes(":")){const _=i.split(":"),h=_[0];a=_[1]||"";let k="";if(_.length>=3&&(k=_[2]),h.includes("-")){const[M,F,S]=h.split("-");o=F,r=S,c=new Date(parseInt(S),parseInt(F)-1,parseInt(M))}else[o,r]=h.split("/"),c=new Date(2e3+parseInt(r),parseInt(o)-1);k&&(a+=`|${k}`)}else[o,r]=i.split("/"),c=new Date(2e3+parseInt(r),parseInt(o)-1);let l="",d=a;if(a.includes("|")){const _=a.split("|");d=_[0],l=_[1]}if(!o||!r)return{original:i,monthsAgo:0,fighterId:d,fighter:e.find(_=>_.ufcstats_url.endsWith(d))??null,dateString:i,result:l||void 0};const u=n.getTime()-c.getTime(),g=Math.floor(u/(1e3*60*60*24*30.44)),f=String(o).padStart(2,"0"),m=r.length===4?r.slice(2):r;return{original:`${f}/${m}`,monthsAgo:Math.max(0,g),fighterId:d,fighter:e.find(_=>_.ufcstats_url.endsWith(d))??null,dateString:`${f}/${m}`,result:l||void 0}}).sort((i,o)=>i.monthsAgo-o.monthsAgo)}function Bt(t){if(!t)return 0;const e=t.split(",").map(o=>{const r=o.trim().split(":");if(r.length<3)return null;const[c,a,l]=r,[d,u,g]=c.split("-").map(Number);return{date:new Date(g,u-1,d),result:l.trim()}}).filter(o=>o!==null);if(e.sort((o,r)=>r.date.getTime()-o.date.getTime()),e.length===0)return 0;const s=e[0].result;if(s==="D"||s==="NC")return 0;let n=0;const i=s;for(const o of e)if(!(o.result==="NC"||o.result==="D"))if(o.result===i)n++;else break;return i==="W"?n:-n}function Nt(t){if(!t||t.trim()==="")return null;const e=/^(\d{1,2})-(\d{1,2})-(\d{4})$/,s=t.match(e);if(s){const[,n,i,o]=s,r=new Date(parseInt(o),parseInt(i)-1,parseInt(n));if(r.getDate()===parseInt(n)&&r.getMonth()===parseInt(i)-1&&r.getFullYear()===parseInt(o))return r}return null}function It(t){if(!t||t.trim()==="")return 0;const e=Nt(t);if(!e)return 0;const s=new Date;let n=s.getFullYear()-e.getFullYear();const i=s.getMonth()-e.getMonth();return(i<0||i===0&&s.getDate()<e.getDate())&&n--,Math.max(0,n)}function ce(){const e=gt(mt)("charts.fight_radar_categories");return Array.isArray(e)?e:["Striking Offense","Striking Defense","Takedown Offense","Takedown Defense","Control","Finish Threat"]}function ae(){const e=gt(mt)("charts.iq_radar_categories");return Array.isArray(e)?e:["Distance","Adaptability","Composure","Decisions","Rhythm","Feints"]}function Tt(t){const e=Number(t.Sig_Strikes_Landed)||0,s=Number(t.Sig_Strikes_Thrown)||0,n=Number(t.Sig_Strikes_Absorbed)||0,i=Number(t.significant_strikes_attempted_against)||0,o=Number(t.Takedowns_Successful)||0,r=Number(t.Takedowns_Attempted)||0,c=Number(t.Takedowns_Defended)||0,a=Number(t.takedowns_attempted_against)||0,l=Number(t.Control_Time_Seconds)||0,d=Number(t.Time_Controlled_Seconds)||0,u=Number(t.Number_of_Fights_36m)||1,g=Number(t.win_ko)||0,f=Number(t.win_tko)||0,m=Number(t.win_sub)||0;let _=s>0?e/s*100:0,h=i>0?(i-n)/i*100:85,k=r>0?o/r*100:45,M=a>0?c/a*100:85,F=l+d>0?l/(l+d)*100:50,S=u>0?(g+f+m)/u*100:0;const p={STR_OFF:_,STR_DEF:h,TD_OFF:k,TD_DEF:M,CTRL:F,FIN_THREAT:S};return{STR_OFF:p.STR_OFF>100?100:Math.round(p.STR_OFF),STR_DEF:p.STR_DEF>100?100:Math.round(p.STR_DEF),TD_OFF:p.TD_OFF>100?100:Math.round(p.TD_OFF),TD_DEF:p.TD_DEF>100?100:Math.round(p.TD_DEF),CTRL:p.CTRL>100?100:Math.round(p.CTRL),FIN_THREAT:p.FIN_THREAT>100?100:Math.round(p.FIN_THREAT)}}function Lt(t,e){const s=t.Sig_Strikes_Landed||0,n=t.Sig_Strikes_Thrown||0,i=t.Sig_Strikes_Absorbed||0,o=t.significant_strikes_attempted_against||0,r=t.Takedowns_Defended||0,c=t.takedowns_attempted_against||0,a=t.Fight_Duration_Seconds||1,l=t.win||0,d=t.loss||0,u=t.draws||0,g=t.win_ko||0,f=t.win_tko||0,m=t.win_sub||0,_=t.Knockdowns||0,h=t.Knockdowns_Received||0,k=a/60,M=l+d+u||1,F=k>0?s/(k*M):0,S=n>0?s/n*100:0,p=o>0?i/o*100:0,T=c>0?r/c*100:0,R=l/M,L=(g+f+m)/M*100,E=t.reach_inches||70,B=t.height_inches||70,O=E-B,C=Math.min(Math.max(O-2,0),10)*4,D=s-i,Q=D>0?Math.min(D*.3,40):Math.max(D*.2,-20),K=40+C+Q,Y=Math.round(Math.min(Math.max(K,15),85)),v=(p+T)/2-i/Math.max(M,1),G=Math.max(v*.8,0),N=k*M,q=N>10?Math.min((N-10)*2,25):0,z=M-h,J=Math.min(z*3,20),Z=40+G+q+J,$=Math.round(Math.min(Math.max(Z,20),85)),X=Math.min(R*.4,.4),P=((g>0?1:0)+(f>0?1:0)+(m>0?1:0))/3*.15;let A=0;e.isTriple?A=.25:e.isDual?A=.15:A=-.1;const V=X+P+A,tt=Math.round(Math.min(Math.max(V*100,5),95)),y=R>L/100?Math.min((R-L/100)*50,25):0,et=t.Takedowns_Attempted>0?t.Takedowns_Successful/t.Takedowns_Attempted*30:15,st=t.Control_Time_Seconds||0,it=t.Time_Controlled_Seconds||0,I=st-it,j=I>0?Math.min(I*.15,20):Math.max(I*.1,-15),nt=35+y+et+j,ot=Math.round(Math.min(Math.max(nt,15),85)),rt=n-i,ct=rt>0?Math.min(rt*.25,30):0,x=k*M,at=x<8?Math.min((8-x)*5,25):x>12?Math.max((12-x)*2,-15):10,ft=F>3?Math.min((F-3)*8,20):F*6,lt=35+ct+at+ft,dt=Math.round(Math.min(Math.max(lt,15),85)),pt=n>0?S/100:0,vt=pt>.5?Math.min((pt-.5)*80,30):0,ht=_-h,wt=ht>0?Math.min(ht*15,25):Math.max(ht*5,-15),At=I>60?Math.min((I-60)*.1,15):0,yt=35+vt+wt+At,bt=Math.round(Math.min(Math.max(yt,15),85));return{distance:Y,adaptability:tt,composure:$,decisions:ot,rhythm:dt,feints:bt}}function Ot(t){const e=t.trim().split(`
`),s=e[0].split(",").map(i=>i.replace(/"/g,"").trim()),n=[];for(let i=1;i<e.length;i++){const o=Ct(e[i]);if(o.length!==s.length){console.warn(`LÃ­nea ${i+1} tiene ${o.length} campos, esperados ${s.length}`);continue}const r={};s.forEach((a,l)=>{r[a]=o[l]});const c=Kt(r);c&&n.push(c)}return n}function Ct(t){const e=[];let s="",n=!1;for(let i=0;i<t.length;i++){const o=t[i];o==='"'?n=!n:o===","&&!n?(e.push(s.trim()),s=""):s+=o}return e.push(s.trim()),e}function Kt(t){try{const e=t.Division,s=t.Fighter;if(!e||!s)return null;const n=s.replace(/"/g,"");return{id:t.ufcstats_url&&t.ufcstats_url.split("/").pop()||"",Fighter:n,cleanName:Et(n),Division:e,Birth_Date:t.Birth_Date||"",Career_Record:t.Career_Record||"",Sig_Strikes_Thrown:parseFloat(t.Sig_Strikes_Thrown)||0,Sig_Strikes_Landed:parseFloat(t.Sig_Strikes_Landed)||0,Sig_Strikes_Absorbed:parseFloat(t.Sig_Strikes_Absorbed)||0,Takedowns_Attempted:parseFloat(t.Takedowns_Attempted)||0,Takedowns_Successful:parseFloat(t.Takedowns_Successful)||0,Takedowns_Defended:parseFloat(t.Takedowns_Defended)||0,Sub_Attempts:parseFloat(t.Sub_Attempts)||0,Sub_Attempts_Defended:parseFloat(t.Sub_Attempts_Defended)||0,Knockdowns:parseFloat(t.Knockdowns)||0,Knockdowns_Received:parseFloat(t.Knockdowns_Received)||0,Control_Time_Seconds:parseFloat(t.Control_Time_Seconds)||0,Time_Controlled_Seconds:parseFloat(t.Time_Controlled_Seconds)||0,height_inches:parseFloat(t.height_inches)||0,reach_inches:parseFloat(t.reach_inches)||0,win:parseFloat(t.win)||0,loss:parseFloat(t.loss)||0,draws:parseFloat(t.draws)||0,win_ko:parseFloat(t.win_ko)||0,win_tko:parseFloat(t.win_tko)||0,win_sub:parseFloat(t.win_sub)||0,win_decision:parseFloat(t.win_decision)||0,loss_ko:parseFloat(t.loss_ko)||0,loss_tko:parseFloat(t.loss_tko)||0,loss_sub:parseFloat(t.loss_sub)||0,loss_decision:parseFloat(t.loss_decision)||0,Fight_Duration_Seconds:parseFloat(t.Fight_Duration_Seconds)||1,significant_strikes_attempted_against:parseFloat(t.significant_strikes_attempted_against)||0,takedowns_attempted_against:parseFloat(t.takedowns_attempted_against)||0,takedowns_allowed:parseFloat(t.takedowns_allowed)||0,submission_attempts_against:parseFloat(t.submission_attempts_against)||0,Number_of_Fights_36m:parseFloat(t.Number_of_Fights_36m)||0,Dates_36m:t.Dates_36m||"",picture_url:t.picture_url||"",ufcstats_url:t.ufcstats_url||""}}catch(e){return console.error("Error procesando luchador:",t.Fighter||t.Name,e),null}}async function $t(t){const e=await fetch(t);if(!e.ok)throw new Error(`No se pudo cargar ${t}: ${e.status}`);return await e.text()}async function le(t){try{const e=await fetch(t,{method:"HEAD"});if(!e.ok)throw new Error(`No se pudo obtener informaciÃ³n del archivo ${t}: ${e.status}`);const s=e.headers.get("last-modified"),n=e.headers.get("content-length"),i=e.headers.get("etag");return{lastModified:s?new Date(s):null,size:n?parseInt(n,10):null,etag:i||null}}catch(e){return console.warn(`Error getting file stats for ${t}:`,e),{lastModified:null,size:null,etag:null}}}class Rt{constructor(e){this.metrics=this.calculateMetrics(e)}calculateMetrics(e){const s=e.win||0,n=e.loss||0,i=e.draws||0,o=s+n+i,r=e.win_ko||0,c=e.win_tko||0,a=e.win_sub||0,l=e.Knockdowns||0,d=e.Knockdowns_Received||0,u=n===0&&s>0,g=o>0?s/o:0,f=r+c+a,m=o>0?f/o*100:0,_=d>0?l/d:l+1,h=e.Fight_Duration_Seconds>0?e.Fight_Duration_Seconds/60:15;return{isUndefeated:u,wins:s,losses:n,winRate:g,finishRate:m,totalFights:e.Number_of_Fights_36m||o,knockdowns:l,knockdownsReceived:d,knockdownRatio:_,subWins:a,koTkoWins:r+c,avgFightTime:h,isEliteFinisher:m>70&&o>=4,isSubmissionSpecialist:a>=3&&u,isKnockoutArtist:r+c>=3&&l>d+2}}getStrikingOffenseBonuses(){const e=this.metrics;return e.isUndefeated&&e.isEliteFinisher?{primary:e.isKnockoutArtist?1.44:1.25,secondary:1.15,additive:8}:e.isUndefeated&&e.finishRate>50?{primary:1.18,secondary:1.1,additive:5}:e.isUndefeated&&e.totalFights>=3?{primary:1.12,secondary:1.05,additive:3}:e.winRate>.85&&e.totalFights>=5?{primary:1.08,secondary:1.03,additive:2}:{primary:1,secondary:1,additive:0}}getDefensiveBonuses(){const e=this.metrics;return e.winRate===1&&e.totalFights>=4?{primary:1.15,secondary:1.1,additive:4}:e.winRate>.9&&e.totalFights>=4?{primary:1.08,secondary:1.05,additive:2}:{primary:1,secondary:1,additive:0}}getFinishingBonuses(){const e=this.metrics;return e.isUndefeated&&e.isEliteFinisher?{primary:e.isSubmissionSpecialist?1.68:1.4,secondary:1.2,additive:15}:e.isUndefeated&&e.finishRate>50?{primary:1.3,secondary:1.15,additive:10}:e.isUndefeated&&e.totalFights>=3?{primary:1.2,secondary:1.1,additive:6}:{primary:1,secondary:1,additive:0}}getControlBonuses(){const e=this.metrics;return e.isSubmissionSpecialist?{primary:1.25,secondary:1.15,additive:8}:e.isUndefeated&&e.totalFights>=4?{primary:1.1,secondary:1.05,additive:3}:{primary:1,secondary:1,additive:0}}getVolumeBonuses(){const e=this.metrics;if(e.isUndefeated&&e.isEliteFinisher){let s=1.4,n=30;return e.isKnockoutArtist&&(s*=1.15,n+=12),e.isSubmissionSpecialist&&(s*=1.18,n+=15),{primary:Math.min(s,1.8),secondary:1.18,additive:Math.min(n,50)}}else{if(e.isUndefeated&&e.finishRate>50)return{primary:1.25,secondary:1.12,additive:20};if(e.isUndefeated&&e.totalFights>=3)return{primary:1.15,secondary:1.08,additive:15}}return{primary:1,secondary:1,additive:0}}getEliteClassification(){const e=this.metrics;return e.isUndefeated&&e.isEliteFinisher?e.isKnockoutArtist&&e.isSubmissionSpecialist?"Complete Dominator":e.isKnockoutArtist?"Knockout Artist":e.isSubmissionSpecialist?"Submission Specialist":"Elite Finisher":e.isUndefeated&&e.finishRate>50?"Undefeated Finisher":e.isUndefeated?"Undefeated Prospect":e.winRate>.85&&e.totalFights>=6?"Elite Veteran":"Standard Fighter"}getMetrics(){return{...this.metrics}}}function Pt(t,e){let s=null,n=null;if(xt(t))s="AT",n=b[s];else{const nt=e.map(dt=>kt(dt)),ot=Math.round(W(nt)),ct=kt(t)>=ot?"A":"P",x=e.map(ut),at=Math.round(W(x)),lt=ut(t)>=at?"T":"NT";s=`${ct}${lt}`,n=b[s]}const i=e.map(Ft),o=Math.round(W(i)),r=Math.min(...i),c=Math.max(...i),a=(r+o)/2,l=(o+c)/2,d=Ft(t),u=d>=o?"A":"P";let g="Muy Bajo";d>=l?g="Muy Alto":d>=o?g="Medio-Alto":d>=a&&(g="Medio-Bajo");const f=e.map(H),m=Math.round(W(f)),_=Math.min(...f),h=Math.max(...f),k=(_+m)/2,M=(m+h)/2,F=H(t),S=F>=m?"T":"NT";let p="Muy Bajo";F>=M?p="Muy Alto":F>=m?p="Medio-Alto":F>=k&&(p="Muy Bajo");let T=g==="Muy Alto"&&p==="Medio-Bajo"||g==="Medio-Alto"&&p==="Muy Alto"||g==="Medio-Bajo"&&p==="Medio-Alto"||g==="Muy Bajo"&&p==="Muy Bajo";const R=`${u}${S}`,L=b[R];T=T&&s!==R;const E=e.map(Mt),B=Math.round(W(E)),O=Math.min(...E),C=Math.max(...E),D=(O+B)/2,Q=(B+C)/2,K=Mt(t),Y=K>=B?"A":"P";let v="Muy Bajo";K>=Q?v="Muy Alto":K>=B?v="Medio-Alto":K>=D&&(v="Medio-Bajo");const G=e.map(St),N=Math.round(W(G)),q=Math.min(...G),z=Math.max(...G),J=(q+N)/2,Z=(N+z)/2,$=St(t),X=$>=N?"T":"NT";let w="Muy Bajo";$>=Z?w="Muy Alto":$>=N?w="Medio-Alto":$>=J&&(w="Muy Bajo");let P=v==="Muy Bajo"&&w==="Medio-Bajo"||v==="Medio-Bajo"&&w==="Muy Alto"||v==="Medio-Alto"&&w==="Medio-Alto"||v==="Muy Alto"&&w==="Muy Bajo";const A=`${Y}${X}`,V=b[A];P=P&&![s,R].includes(A);const tt=`${n}${T?L:""}${P?V:""}`,y=`${s}${T?`+${R}`:""}${P?`+${A}`:""}`,et=`@ARCHETYPE_${y}_DESCRIPTION`,st=`@ARCHETYPE_${y}_FAVORITE_ZONE`,it=`@ARCHETYPE_${y}_STRENGTHS`,I=`@ARCHETYPE_${y}_WEAKNESSES`,j=y.split("+").length;return{combinedRole:y,inTransition:j>1,isDual:j===2,isTriple:j===3,archetypeEmojis:tt,description:et,favoriteZone:st,strengths:it,weaknesses:I}}function kt(t){const e=t.Sig_Strikes_Thrown||0,s=t.Takedowns_Attempted||0,n=t.Sub_Attempts||0,i=t.Control_Time_Seconds||0,r=(t.Fight_Duration_Seconds||1)/60,c=r>0?i/r:0,a=30,l=.25,d=c>a?6:7,u=c/d,g=e+s+n+u,f=r>0?g/r:0,m=ut(t),_=H(t);let h=f*.35+m*.35+_*.3;const k=i/(e+i+1);if(k>l*1.5&&c>a*1.2){const S=Math.max(0,c/a-1),p=Math.max(0,k/l-1),T=(S+p)*2.5;h+=T}if(m>60){const S=1+(m-60)/200;h*=S}if(r<6&&_>60){const S=(6-r)/6*(_/100)*10;h+=S}const F=new Rt(t).getVolumeBonuses();return h=(h+F.additive)*F.primary,Math.round(h*100)/100}function ut(t){const e=t.Sig_Strikes_Landed||0,s=t.Sig_Strikes_Thrown||0,n=t.Takedowns_Successful||0,i=t.Takedowns_Attempted||0,r=H(t)>50,c=r?.9:.85,a=r?.1:.15,l=s>0?e/s*100:0,d=i>0?n/i*100:0;let u=0;if(s>0&&i>0)u=l*c+d*a;else if(s>0)u=l;else if(i>0)u=d;else return 50;const g=t.loss_ko||0,f=t.loss_tko||0,m=t.loss_sub||0,_=t.Knockdowns_Received||0,h=t.Number_of_Fights_36m,k=h>0?(g+f+m)/h:0,M=h>0?_/h:0,F=(t.Fight_Duration_Seconds||300)/60,S=t.significant_strikes_attempted_against>0?(t.significant_strikes_attempted_against-t.Sig_Strikes_Absorbed)/t.significant_strikes_attempted_against:.6,T=F>8&&S>.6?.6:1,R=Math.min(k*1*T,.45),L=Math.min(M*.4*T,.15),E=Math.min(R+L,.55),O=new Rt(t).getStrikingOffenseBonuses();if(u=(u+O.additive)*O.primary,u=u*(1-E),u>55){const C=(u-55)/45*10;u+=C}return Math.min(Math.round(u),100)}function H(t){const e=t.win||0,s=t.loss||0,n=t.draws||0,i=t.win_ko||0,o=t.win_tko||0,r=t.win_sub||0,c=e+s+n;if(c===0)return 0;let a=(i+o+r)/c*100;const l=i+o+r,d=c>0?e/c:0,u=t.Fight_Duration_Seconds>0?t.Fight_Duration_Seconds/60:15;if(u<8&&a>30){const h=Math.min((8-u)*2,8);a+=h}const g=(i>0?1:0)+(o>0?1:0)+(r>0?1:0);if(g>=2&&l>=3){const h=g*2;a+=h}const f=c>0?(i+o)/c*100:0;if(f>40){const h=Math.min((f-40)*.15,6);a+=h}const m=c>0?r/c*100:0,_=c>0?t.Sub_Attempts/c:0;if(m>20||_>1.5){const h=Math.min(m*.1+_,4);a+=h}if(d>.85&&c>=5){const h=Math.min((d-.85)*20,3);a+=h}if(t.reach_inches>72&&t.height_inches>70){const h=Math.min((t.reach_inches-72)*.1,2);a+=h}return Math.min(a,100)}function Ft(t){const e=t.Knockdowns||0,s=t.Knockdowns_Received||0,n=t.Number_of_Fights_36m||1,o=(e+s)/n;let r=(1-Math.exp(-o*1.5))*100;const c=t.win||0;t.loss;const a=t.win_ko||0,l=t.win_tko||0,d=s>0?e/s:e+1;if(e>s&&e>0){const h=Math.min(d*4,12);r+=h}const u=a+l;if(u>0&&n>0){const h=u/n,k=Math.min(h*15,10);r+=k}const g=n>0?t.Sig_Strikes_Thrown/n:0;if(g>100&&e>n*.3){const h=Math.min((g-100)*.03,5);r+=h}const f=n>0?t.Sig_Strikes_Absorbed/n:0,m=n>0?c/n:0;if(f>80&&m>.7&&s<n){const h=Math.min((f-80)*.02,3);r+=h}const _=n>0?(a+l+t.win_sub)/n:0;if(_>.4&&e>=n*.2){const h=Math.min(_*8,6);r+=h}return Math.min(Math.ceil(r*100)/100,100)}function Mt(t){const s=(t.Fight_Duration_Seconds||0)/60;return Math.round(s*100)/100}function St(t){const e=t.Control_Time_Seconds||0,s=t.Time_Controlled_Seconds||0,n=t.Number_of_Fights_36m||1,i=(e+s)/n,o=t.Fight_Duration_Seconds||300,r=i/o*100;return Math.min(Math.round(r*100)/100,100)}const W=t=>{const e=[...t].sort((n,i)=>n-i),s=Math.floor(e.length/2);return e.length%2!==0?e[s]:(e[s-1]+e[s])/2};function xt(t){const{win:e,loss:s,Number_of_Fights_36m:n}=t;if(n<3)return!1;const i=n>0?e/n:0,o=H(t)/100,r=(t.Fight_Duration_Seconds||300)/60,c=(s||0)===0&&e>0,a=Tt(t),l=(a.STR_DEF+a.TD_DEF)/2,d=[],u=i>=.75&&o>=.6&&r<=8;d.push(u);const g=c&&e>=5&&(o>=.4||l>=75)&&r<=10;d.push(g);const f=e>0?(t.win_ko+t.win_tko)/e:0,m=(t.Knockdowns_Received||0)>0?(t.Knockdowns||0)/(t.Knockdowns_Received||1):(t.Knockdowns||0)+1,_=i>=.7&&f>=.5&&m>=2&&a.STR_DEF>=70;d.push(_);const h=t.Sig_Strikes_Thrown>0?t.Sig_Strikes_Landed/t.Sig_Strikes_Thrown:0,k=t.Takedowns_Attempted>0?t.Takedowns_Successful/t.Takedowns_Attempted:0,M=i>=.8&&h>=.45&&(k>=.4||t.Takedowns_Attempted<3)&&l>=70&&o>=.35;d.push(M);const F=n>=6,S=t.Sig_Strikes_Absorbed/Math.max(t.Number_of_Fights_36m,1)<60,p=F&&i>=.85&&S&&(o>=.3||l>=80);return d.push(p),d.some(R=>R)}function Wt(t){return Math.round(Object.values(t).reduce((e,s)=>e+s,0)/6)}function Dt(t){const e=t.win||0,s=t.loss||0,n=t.Number_of_Fights_36m||0,i=(t.win_ko||0)+(t.win_tko||0)+(t.win_sub||0),r=(t.Career_Record||"0-0-0").split("-"),c=parseInt(r[0])||0,a=parseInt(r[1])||0,l=c+a;let d=0;return n>=4&&e>=4&&s===0&&l>=15?d=12:n>=4&&e>=3&&s<=1&&l>=12?d=10:n>=3&&e>=3&&l>=20&&c>=15?d=8:n>=3&&e>=2&&s<=1&&i>=2?d=6:n>=3&&e>=2&&l>=10&&(d=4),d}function Gt(t,e,s){const n=Object.values(t).reduce((r,c)=>r+c,0)/6,i=Object.values(e).reduce((r,c)=>r+c,0)/6;let o=Math.round(n*.6+i*.4);if(s){const r=s.win||0,c=(s.win_ko||0)+(s.win_tko||0)+(s.win_sub||0),l=(r>0?c/r:0)*8;o+=l;const d=Dt(s);if(o+=d,s.Number_of_Fights_36m<3)o=Math.min(o,65);else if(s.Number_of_Fights_36m===3){o=Math.min(o,70);const u=s.win||0,g=s.loss||0,f=s.draws||0,m=u+g+f,_=(s.Career_Record||"0-0-0").split("-").reduce((h,k)=>h+parseInt(k)||0,0);if(m>=3&&_>=8){const h=u/m;h>=.9?o+=6:h>=.8?o+=4:h>=.7&&(o+=2)}}else if(s.Number_of_Fights_36m>=4){const u=s.win||0,g=s.loss||0,f=s.draws||0,m=u+g+f;if(m>=4){const _=u/m;_>=.9?o+=12:_>=.8?o+=8:_>=.7?o+=5:_>=.6&&(o+=2)}}}return Math.max(0,Math.min(100,Math.round(o)))}function jt(t){return Math.round(Object.values(t).reduce((e,s)=>e+s,0)/6)}function _t(t){return t<25?1:t<35?1.5:t<45?2:t<55?2.5:t<65?3:t<75?3.5:t<85?4:t<95?4.5:5}function Ut(t,e){if(e===0)return _t(t);let s;e<5?s=.7+e*.06:s=Math.min(1.6,1+(e-5)*.12);const n=t*s;return _t(n)}function Ht(t){if(!t||t.trim()==="")return"";const[e,s,n]=t.split("-").map(Number);return!e||!s||!n?t:`${e.toString().padStart(2,"0")}/${s.toString().padStart(2,"0")}/${n}`}function Qt(t,e){try{const s=Tt(t),n=Pt(t,e),i=Lt(t,n),o=Gt(s,i,t),r=_t(o);return{id:t.id,name:t.cleanName,nameWithNickname:t.Fighter,division:t.Division,birthDate:Ht(t.Birth_Date),age:It(t.Birth_Date),career_record:t.Career_Record||"TBD",record_36m:`${t.win}-${t.loss}-${t.draws}`,pictureUrl:t.picture_url||"",ufcstats_url:t.ufcstats_url||"",fightRadar:s,iqRadar:i,archetype:n,stars:r,performance:Wt(s),overall:o,fightIQ:jt(i),oppTierScore:0,streak:Bt(t.Dates_36m||""),rawData:t}}catch(s){return console.error("Error processing fighter:",t.Fighter,s),null}}function Yt(t){return t>=85?"ELITE":t>=75?"CONTENDER":t>=65?"SOLID":t>=50?"MEDIOCRE":"TERRIBLE"}const qt={ELITE:{W:10,L:7,D:8,NC:0},CONTENDER:{W:8,L:5,D:6,NC:0},SOLID:{W:6,L:3,D:4,NC:0},MEDIOCRE:{W:4,L:1,D:2,NC:0},TERRIBLE:{W:2,L:0,D:1,NC:0}};function zt(t,e){if(t!=="W"||!e)return 1;switch(e.toUpperCase()){case"KO":case"TKO":case"KO/TKO":return 1.3;case"SUB":case"SUBMISSION":return 1.2;case"DEC":case"DECISION":return 1;default:return 1}}function Jt(t){if(!t||t.length===0)return 0;let e=0,s=0;if(t.forEach(o=>{if(!o.opponent||typeof o.opponent.overall!="number")return;const r=Yt(o.opponent.overall),c=qt[r]?.[o.result]??0,a=zt(o.result,o.method);let l=1;r==="ELITE"?l=2:r==="CONTENDER"?l=1.5:r==="SOLID"?l=1:r==="MEDIOCRE"?l=.7:r==="TERRIBLE"&&(l=.5);const d=c*a;e+=d*l,s+=l}),s===0)return 0;const n=e/s,i=Math.max(0,Math.min(10,n));return Math.round(i*100)/100}function Zt(t){if(!t)return[];const e=t.split(",").map(n=>n.trim()).filter(n=>n),s=new Date;return e.map(n=>{const i=n.split(":");if(i.length<3)return null;const[o,r,c]=i,[a,l,d]=o.split("-").map(Number);if(!a||!l||!d)return null;const u=new Date(d,l-1,a),g=s.getTime()-u.getTime(),f=Math.floor(g/(1e3*60*60*24*30.44));return{fighterId:r,result:c.trim(),monthsAgo:Math.max(0,f)}}).filter(n=>n!==null)}function Xt(t){const e=new Map;t.forEach(i=>{e.has(i.Division)||e.set(i.Division,[]),e.get(i.Division).push(i)});const s=[],n=new Map;return e.forEach(i=>{i.forEach(o=>{const r=Qt(o,i);r&&(s.push(r),n.set(r.nameWithNickname,r))})}),s.forEach(i=>{const o=Zt(i.rawData.Dates_36m);if(o.length>0){const r=[];o.forEach(c=>{const a=s.find(l=>l.id===c.fighterId);a&&c.result&&r.push({opponent:{overall:a.overall},result:c.result,method:void 0,monthsAgo:c.monthsAgo})}),i.oppTierScore=Jt(r)}else i.oppTierScore=0}),s.forEach(i=>{i.stars=Ut(i.overall,i.oppTierScore)}),s.sort((i,o)=>o.stars!==i.stars?o.stars-i.stars:o.overall-i.overall),{processedFighters:s,fightersByDivision:e,fightersMap:n}}class Vt{constructor(){this.allRawFightersArr=[],this.allRawFightersDataMap=new Map,this.allRawFightersByDivision=new Map,this.processedFightersMap=new Map,this.processedFighters=[],this.knownDivisions=new Set,this.cacheKey="ufc_radar_fighters_cache",this.cacheExpiryHours=24,this.DATA_VERSION="1759518790183",this.fightersProcessed=!1,this.isLoading=!1,this.loadingPromise=null}saveToLocalStorage(e){try{const s={...e,dataVersion:this.DATA_VERSION};localStorage.setItem(this.cacheKey,JSON.stringify(s))}catch(s){console.warn("Failed to save data to localStorage:",s)}}loadFromLocalStorage(){try{const e=localStorage.getItem(this.cacheKey);if(!e)return null;const s=JSON.parse(e);if(s.dataVersion!==this.DATA_VERSION)return console.log("Cache invalidated: version mismatch",{cached:s.dataVersion,current:this.DATA_VERSION}),localStorage.removeItem(this.cacheKey),null;const i=Date.now()-s.timestamp,o=this.cacheExpiryHours*60*60*1e3;return i>o?(localStorage.removeItem(this.cacheKey),null):s}catch(e){return console.warn("Failed to load data from localStorage:",e),localStorage.removeItem(this.cacheKey),null}}populateFromCache(e){this.processedFighters=e.processedFighters||[],this.allRawFightersArr=[],this.allRawFightersDataMap.clear(),this.allRawFightersByDivision.clear(),this.processedFightersMap.clear(),this.processedFighters.forEach(s=>{this.allRawFightersArr.push(s.rawData),this.allRawFightersDataMap.set(s.rawData.Fighter,s.rawData),this.allRawFightersByDivision.has(s.rawData.Division)||this.allRawFightersByDivision.set(s.rawData.Division,[]),this.allRawFightersByDivision.get(s.rawData.Division)?.push(s.rawData),this.processedFightersMap.set(s.nameWithNickname,s)}),this.knownDivisions.clear(),e.knownDivisions.forEach(s=>{this.knownDivisions.add(s)}),this.processedFighters.sort((s,n)=>n.stars!==s.stars?n.stars-s.stars:n.overall-s.overall)}async loadFightersFromCSV(){if(this.allRawFightersDataMap.size>0&&this.fightersProcessed)return{allRawFightersArr:this.allRawFightersArr,allRawFightersDataMap:this.allRawFightersDataMap,allRawFightersByDivision:this.allRawFightersByDivision,processedFightersMap:this.processedFightersMap,processedFighters:this.processedFighters};if(this.isLoading&&this.loadingPromise)return this.loadingPromise;const e=this.loadFromLocalStorage();if(e)return this.populateFromCache(e),this.fightersProcessed=!0,{allRawFightersArr:this.allRawFightersArr,allRawFightersDataMap:this.allRawFightersDataMap,allRawFightersByDivision:this.allRawFightersByDivision,processedFightersMap:this.processedFightersMap,processedFighters:this.processedFighters};this.isLoading=!0,this.loadingPromise=this.performActualLoad();try{return await this.loadingPromise}finally{this.isLoading=!1,this.loadingPromise=null}}async performActualLoad(){try{const e=await $t("data/ALL_DIVISIONS_DATA_WITH_URLS.csv");this.allRawFightersArr=Ot(e),this.allRawFightersArr.forEach(r=>{this.allRawFightersDataMap.has(r.Fighter)||this.allRawFightersDataMap.set(r.Fighter,r),this.allRawFightersByDivision.has(r.Division)?this.allRawFightersByDivision.get(r?.Division)?.push(r):this.allRawFightersByDivision.set(r.Division,[r])});const s=Xt(this.allRawFightersArr);this.processedFighters=s.processedFighters,this.allRawFightersByDivision=s.fightersByDivision,this.processedFightersMap=s.fightersMap;const n=new Map,i=new Map;this.processedFighters.forEach(r=>{n.set(r.nameWithNickname,r.stars),i.set(r.nameWithNickname,r.overall)}),this.allRawFightersArr.sort((r,c)=>{const a=n.get(r.Fighter)??0,l=n.get(c.Fighter)??0,d=i.get(r.Fighter)??0,u=i.get(c.Fighter)??0;return l!==a?l-a:u-d}),this.allRawFightersByDivision.forEach((r,c)=>{r.sort((a,l)=>{const d=n.get(a.Fighter)??0,u=n.get(l.Fighter)??0,g=i.get(a.Fighter)??0,f=i.get(l.Fighter)??0;return u!==d?u-d:f-g})}),this.knownDivisions.clear(),this.allRawFightersArr.forEach(r=>{const c=r.Division.toLowerCase();this.knownDivisions.add(c),this.knownDivisions.add(c.replace(/ /g,"_")),this.knownDivisions.add(c.replace(/women's\s+/g,"w_")),this.knownDivisions.add(c.replace(/w_/g,"women's "))});const o={timestamp:Date.now(),dataVersion:this.DATA_VERSION,processedFighters:this.processedFighters,knownDivisions:Array.from(this.knownDivisions)};return this.saveToLocalStorage(o),this.fightersProcessed=!0,{allRawFightersArr:this.allRawFightersArr,allRawFightersDataMap:this.allRawFightersDataMap,allRawFightersByDivision:this.allRawFightersByDivision,processedFightersMap:this.processedFightersMap,processedFighters:this.processedFighters}}catch(e){return console.error("Error loading fighters:",e),{allRawFightersArr:this.allRawFightersArr,allRawFightersDataMap:this.allRawFightersDataMap,allRawFightersByDivision:this.allRawFightersByDivision,processedFightersMap:this.processedFightersMap,processedFighters:this.processedFighters}}}searchFighterByNameAndNickname(e,s=20){const n=this.processedFighters,i=U(e);return n.find(o=>U(o.nameWithNickname)===i)??null}searchFightersByDivision(e){const s=this.processedFighters,n=U(e),i=U(n.replace(/womens\s+/g,"w"));return this.knownDivisions.has(n)||this.knownDivisions.has(i)?s.filter(c=>{const a=U(c.division);return a===n||a===i}):[]}getFighterById(e){return this.processedFighters.find(n=>n.id===e)||null}}const de=new Vt;export{ne as a,oe as b,U as c,ce as d,ae as e,de as f,ie as g,se as h,re as i,le as j,Qt as p};
