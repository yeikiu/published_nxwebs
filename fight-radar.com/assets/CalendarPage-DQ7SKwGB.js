import{q as R,f as w,c,t as b,y as u,b as E,o as W,a as ee,p as I,F as te,C as m,z as N,j as ae,u as d,A as y,K as re,i as L,x as _,J as se,a2 as ne,I as ie}from"./lucide-DLzkRcOD.js";import{n as le,$ as oe}from"./index-B1FMFPgI.js";import{C as ce,i as de}from"./fullcalendar-YnvH41mY.js";import{H as ve}from"./Header-BK-tHVTD.js";import"./highcharts-DyRVWUji.js";function ue(f,i){le(i.path)}var fe=w('<div class="nav-breadcrumb svelte-1xign5y"><button class="breadcrumb-link svelte-1xign5y"> </button></div>');function he(f,i){R(i,!0);var h=fe(),p=c(h);p.__click=[ue,i];var l=c(p);b(()=>u(l,i.text)),E(f,h),W()}ee(["click"]);var pe=w('<div class="loading svelte-2p0jch" id="loading"><div class="loading-content svelte-2p0jch"><div class="spinner svelte-2p0jch"></div> <p class="svelte-2p0jch"> </p></div></div>'),ge=w('<div class="error-message svelte-2p0jch" id="error-message"> </div>'),me=w('<div class="calendar-page svelte-2p0jch"><!> <!> <div class="calendar-header svelte-2p0jch"><h1 class="svelte-2p0jch"> </h1> <p class="svelte-2p0jch"> </p></div> <!> <!> <div id="calendar" class="calendar-component svelte-2p0jch"></div></div>');function xe(f,i){R(i,!1);const[h,p]=ie(),l=()=>se(oe,"$_",h);let q=I(i,"isDarkMode",8,!0),B=I(i,"toggleTheme",8,()=>{}),v=null,k=[],x=N(!1),g=N("");te(async()=>{await z(),await C()});async function z(){const e=document.getElementById("calendar");e&&(v=new ce(e,{plugins:[de],initialView:"dayGridMonth",firstDay:1,headerToolbar:{left:"prev,next today",right:"title"},events:[],eventDisplay:"block",eventColor:"var(--event-color)",height:"auto",eventTimeFormat:{hour:"numeric",minute:"2-digit",meridiem:"short"},eventClick:t=>{O(t)}}),v.render())}async function C(){try{m(x,!0),m(g,""),k=await G(),v&&(v.removeAllEvents(),v.addEventSource(k))}catch(e){console.error("Error loading calendar events:",e),m(g,"Error loading UFC events. CORS restrictions may apply. Try running from a local server.")}finally{m(x,!1)}}async function G(){const e="https://raw.githubusercontent.com/clarencechaan/ufc-cal/ics/UFC.ics";let t,s;try{if(t=await fetch(e),t.ok)s=await t.text();else throw new Error("Direct fetch failed")}catch{console.log("Direct fetch failed, trying proxy...");const o=["https://api.allorigins.win/raw?url=","https://cors-anywhere.herokuapp.com/"];for(const r of o)try{if(t=await fetch(r+encodeURIComponent(e)),t.ok){s=await t.text();break}}catch(n){console.log(`Proxy ${r} failed:`,n)}if(!s)throw new Error("All fetch methods failed")}return H(s)}function H(e){const t=[],s=e.split(`
`);let a={},o=!1;for(let r of s)if(r=r.trim(),r==="BEGIN:VEVENT")o=!0,a={};else if(r==="END:VEVENT"&&o){if(a.title&&a.start){const[n,S]=a.title.split(": ");t.push({title:S??n,start:a.start,end:a.end,allDay:a.allDay,color:"var(--event-color)"})}o=!1}else if(o){if(r.startsWith("SUMMARY:"))a.title=r.substring(8);else if(r.startsWith("DTSTART")){const n=r.split(":")[1];r.includes("VALUE=DATE")?(a.start=D(n),a.allDay=!0):(a.start=$(n),a.allDay=!1)}else if(r.startsWith("DTEND")){const n=r.split(":")[1];r.includes("VALUE=DATE")?a.end=D(n):a.end=$(n)}}return t}function $(e){if(e.length===8)return D(e);const t=e.substring(0,4),s=e.substring(4,6),a=e.substring(6,8),o=e.substring(9,11)||"00",r=e.substring(11,13)||"00",n=e.substring(13,15)||"00";return`${t}-${s}-${a}T${o}:${r}:${n}`}function D(e){const t=e.substring(0,4),s=e.substring(4,6),a=e.substring(6,8);return`${t}-${s}-${a}`}function O(e){window?.open(`https://www.google.com/search?q=${e.event.title} ${e.event.start?.toLocaleDateString()}`,"_blank")?.focus()}async function j(){await C()}ae();var T=me(),U=c(T);ve(U,{showThemeToggle:!0,get isDarkMode(){return q()},get toggleTheme(){return B()}});var A=d(U,2);{let e=re(()=>(l(),_(()=>l()("calendar_page.back_to_radar"))));he(A,{get text(){return y(e)},path:"/"})}var V=d(A,2),M=c(V),P=c(M),J=d(M,2),K=c(J),F=d(V,2);{var Y=e=>{var t=pe(),s=c(t),a=d(c(s),2),o=c(a);b(r=>u(o,r),[()=>(l(),_(()=>l()("calendar_page.loading")))]),E(e,t)};L(F,e=>{y(x)&&e(Y)})}var Q=d(F,2);{var X=e=>{var t=ge(),s=c(t);b(()=>u(s,y(g))),E(e,t)};L(Q,e=>{y(g)&&e(X)})}b((e,t)=>{u(P,e),u(K,t)},[()=>(l(),_(()=>l()("calendar_page.title"))),()=>(l(),_(()=>l()("calendar_page.subtitle")))]),E(f,T),ne(i,"refreshEvents",j);var Z=W({refreshEvents:j});return p(),Z}export{xe as default};
